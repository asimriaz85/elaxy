gumtree.GumFormContinueContainer=function(B){if(!(this instanceof (gumtree.GumFormContinueContainer))){return new gumtree.GumFormContinueContainer(B)}var A=this;A.continueContainerSelector=B.continueContainer;A.continueButtonsSelector=B.continueButtons;A.continueContainer=$(this.continueContainerSelector);A.form=A.continueContainer.parent("form");A.targetWidth=A.form.width();A.targetHeight=A.continueContainer.height();A.initialise();$(window).bind("scroll.GumContinueContainer",function(){A.doFloatContinueContainer()});$(window).bind("resize.GumContinueContainer",function(){A.targetWidth=A.form.width();A.positionContainer();A.doFloatContinueContainer()})};gumtree.GumFormContinueContainer.prototype.positionContainer=function(B){var A=this;if(!A.continueContainer.hasClass("no-float")){A.continueContainerPlaceholder.css({"width":A.targetWidth+"px"});A.continueContainer.css({"width":A.targetWidth+"px"})}};gumtree.GumFormContinueContainer.prototype.doFloatContinueContainer=function(){var A=this;if(!A.continueContainer.hasClass("no-float")){A.continueContainerPlaceholder.css({"width":A.targetWidth+"px"});A.continueContainer.css({"width":A.targetWidth+"px"});if(gumtree.utils.isElementInViewport(A.continueContainerPlaceholder.get(0))){A.continueContainer.removeClass("js_floating")}else{if(!gumtree.init.global.isMobile()){A.continueContainer.addClass("js_floating")}else{A.continueContainer.removeClass("js_floating")}}}};gumtree.GumFormContinueContainer.prototype.isContinuable=function(){var A=this,C=A.form.find(".form-component.form-component-mandatory").length,B=A.form.find(".form-component.form-component-mandatory.form-component-success").length;return(C===B)};gumtree.GumFormContinueContainer.prototype.initialise=function(){var A=this;A.continueContainer=$(".submit-button-wrapper");A.continueButtons=A.continueContainer.find(".button");var B=A.continueContainer.hasClass("no-float");A.continueButtons.each(function(){this.removeAttribute("disabled")});if($(".submit-button-wrapper-placeholder").length===0){$('<div class="submit-button-wrapper-placeholder"></div>').insertBefore($(".submit-button-wrapper"));A.continueContainerPlaceholder=$(".submit-button-wrapper-placeholder");if(!B){A.continueContainerPlaceholder.css({"display":"block","height":A.targetHeight+"px","margin-bottom":"-"+A.targetHeight+"px"})}}if(!A.continueButtons.data("GumContinueContainer-event-bound")){A.continueButtons.bind("click",function(E){if(!A.isContinuable()){E.stopImmediatePropagation();E.stopPropagation();E.preventDefault();var D=$(".form-component-error").get(0);if(D){var C=gumtree.utils.elementViewportPosition(D);$(window).scrollTop(C.y)}return false}})}if(A.isContinuable()){A.continueContainer.removeClass("form-not-continuable").addClass(B?"form-continuable-nofloat":"form-continuable")}else{A.continueContainer.removeClass("form-continuable form-continuable-nofloat").addClass(B?"form-continuable-nofloat":"form-not-continuable")}A.continueButtons.data("GumContinueContainer-event-bound",true);A.positionContainer();A.doFloatContinueContainer()};gumtree.GumFormMergable=function(G){if(!(this instanceof (gumtree.GumFormMergable))){return new gumtree.GumFormMergable(G)}var L=this,J=gumtree.utils,H=J.forms.serializeInputs,B=G.form,I=G.formHolderClass,D=B.getAttribute("action"),K,A=G.onChangeHook||function(){};L.submitTriggers=gumtree.utils.get(".button","*",B);L.excludes=G.excludes||[];L.filterSubmits();var F=function(O){O.preventDefault();var S=O.target,R=H(B,O),T=$($(S).data("parent-component")).get(0),N=B.childNodes,Q=[],M=[];if(T&&N){var P="";if(T.id){P=T.id}(function(){var X=false;for(var V=0,U=N.length;V<U;V++){var W=N[V];if(W===T){X=true;var Y=$(W).height();$('<div class="loading" style="z-index:999999999; background-color:#fff; position:absolute; top:0; left:0; width:'+$(W).width()+"px; height:"+$(W).height()+'px"></div>').prependTo($(W))}if(X||!T){if(W&&W.nodeType===1){M.push(W)}}else{if(W.id){Q.push(W.id)}}}}())}if(K){K.abort()}(function(){for(var V=0,U=M.length;V<U;V++){var W=M[V];if(W!=T){$(W).fadeOut("fast")}}}());K=$.ajax({type:"POST",url:D,data:R,success:function(X){if($(X).find(I).length>0){var V=$(X).find(I),U=V.attr("action"),W;A.apply(L,[V.attr("action")]);(function(){for(var b=0,Z=Q.length;b<Z;b++){var Y=Q[b],a=V.find("#"+Y);a.remove()}}());W=V.html();$(B).attr("action",U);if(T){(function(){for(var Z=0,Y=M.length;Z<Y;Z++){var a=M[Z];$(a).animate({opacity:"0.0"}).attr("id","").addClass("js_remove-component")}}());$(B).append(W);$(B).find(".js_remove-component").remove()}else{$(B).html(W);$(B).find(".js_remove-component").remove()}gumtree.init.postAd._onDomChange()}},complete:function(V,W){var U=!($(V.responseText).find(".post-ad-form-flow").length==1);if(W==="parsererror"||U){window.location.reload()}},dataType:"html"})};if(!gumtree.state.GumFormMergableAlreadyMerged){gumtree.state.GumFormMergableAlreadyMerged=[]}for(var E=0,C=L.submitTriggers.length;E<C;E++){if(!gumtree.utils.inArray(L.submitTriggers[E],gumtree.state.GumFormMergableAlreadyMerged)){$(L.submitTriggers[E]).bind("click",F)}gumtree.state.GumFormMergableAlreadyMerged.push(L.submitTriggers[E])}};gumtree.GumFormMergable.prototype.filterSubmits=function(){var C=this,A=[];for(var D=0,B=C.submitTriggers.length;D<B;D++){if(!gumtree.utils.inArray(C.submitTriggers[D],C.excludes)){A.push(C.submitTriggers[D])}}C.submitTriggers=A};gumtree.GumTooltip=function(B){if(!(this instanceof (gumtree.GumTooltip))){return new gumtree.GumTooltip(B)}var A=this;this.topOffset=0;this.id=B.id||"";this.subTooltip=B.subTooltip||false;this.createWrapper();this.tooltip=$("#gumtree-GumTooltip"+this.id);this.tooltipTimeoutDelay=B.tooltipTimeoutDelay||100;this.content=B.content;this.zIndex=B.zIndex||10;this.trigger=$(B.trigger);this.targetClassName=B.className;this.startListeners();this.trigger.attr("title","")};gumtree.GumTooltip.prototype.createWrapper=function(){this.tooltipWrapper=$("#gumtree-GumTooltipWrapper"+this.id);if(this.tooltipWrapper.length===0){$("body").append('<div id="gumtree-GumTooltipWrapper'+this.id+'" style="position:absolute; display:none; width:0; height:0; overflow:visible; "><div id="gumtree-GumTooltip'+this.id+'"></div></div>');this.tooltipWrapper=$("#gumtree-GumTooltipWrapper"+this.id)}};gumtree.GumTooltip.prototype.startListeners=function(){var A=this;this.trigger.bind("mousemove.GumTooltip",function(B){B.stopPropagation()});this.tooltipWrapper.bind("mousemove.GumTooltip",function(B){B.stopPropagation()});this.trigger.bind("mouseover.GumTooltip",function(){if(!A.trigger.hasClass("hovered")){A.trigger.addClass("hovered");A.showTooltip();if(!gumtree.init.global.isMobile()){$(document).one("mousemove.GumTooltip",function(){A.closeTooltip()})}else{setTimeout(function(){var B=A;B.closeTooltip()},4000)}}});$(window).bind("resize",function(){A.placeTooltip()})};gumtree.GumTooltip.prototype.closeTooltip=function(){var A=this;A.trigger.removeClass("hovered");var B=setTimeout(function(){A.hideTooltip()},this.tooltipTimeoutDelay);this.tooltipWrapper.data("tooltipTimeout",B)};gumtree.GumTooltip.prototype.showTooltip=function(){var A=this.tooltipWrapper.data("tooltipTimeout");if(A){clearTimeout(A)}this.tooltip.removeClass();this.tooltip.addClass(this.targetClassName);this.tooltipWrapper.get(0).style.display="block";this.tooltip.html(this.content);if(this.subTooltip){this.subTooltipOffset=$(".tooltip-arrow").height()+2;$(".tooltip-arrow").remove().prependTo("#gumtree-GumTooltip"+this.id).addClass("sub")}this.tooltipWrapper.get(0).style.zIndex=this.zIndex;this.placeTooltip()};gumtree.GumTooltip.prototype.placeTooltip=function(){var G=this.trigger.offset(),I,B,C,N,E,A,J,L=$(window),H=this.tooltip.width(),D=L.width(),M=$(window).scrollLeft(),K=M+D,F=this.tooltip.hasClass("mad-tooltip")?true:false;positionAdjust=F?4:0;G.left+=(this.trigger.width()/2)-((H/2)-positionAdjust);B=this.subTooltip?Math.round(G.top+(this.trigger.height()+this.subTooltipOffset)-this.topOffset):Math.round(G.top-this.tooltip.height()-this.topOffset);I=Math.round(G.left);C=I+H;if(I<M){if(this.trigger.offset().left+(this.trigger.width()/4)<M){B=-100000}else{A=((M-I)+10);I+=A;E=parseInt($(".tooltip-arrow").css("marginLeft"));N=isNaN(E)?0:E;N-=F?A:(A*2);$(".tooltip-arrow").css("marginLeft",N+"px")}}else{if(C>K){if(this.trigger.offset().left+this.trigger.width()-(this.trigger.width()/4)>K){B=-100000}else{J=((C-K)+10);I-=J;N=isNaN(parseInt($(".tooltip-arrow").css("marginLeft")))?0:parseInt($(".tooltip-arrow").css("marginLeft"));N+=F?(J):(J*2);$(".tooltip-arrow").css("marginLeft",N+"px")}}}this.tooltipWrapper.css({top:B+"px",left:I+"px"})};gumtree.GumTooltip.prototype.hideTooltip=function(){this.tooltip.removeClass(this.targetClassName);this.tooltipWrapper.get(0).style.display="none"};gumtree.GumLightbox=function(B){if(!(this instanceof (gumtree.GumLightbox))){return new gumtree.GumLightbox(B)}var A=this;this.trigger=B.trigger;this.wrapperClass=B.wrapperClass;this.surroundClass=B.surroundClass;this.contentsClass=B.contentsClass;this.closeClass=B.closeClass;this.targetAjaxElement=B.targetAjaxElement;this.transitionSpeed=B.transitionSpeed||500;this.lightboxType=B.lightboxType||"ajax";this.autoCenter=B.autoCenter||true;this.htmlSourceScript=B.htmlSourceScript||function(){};this._onAttach=B.onAttach||function(){};this.isAnimating=false;this.scrollContent=B.scrollContent||false;this.maxHeight=B.maxHeight;this.setScroll=B.setScroll||function(){};this.persistContent=B.persistContent||false;this.method=B.method||"GET";var C=gumtree.init.global.isMobile();if(C&&!C.iPad){this.trigger.attr("target","_blank");return }this.lightboxWrapper=$("#gumtree-GumLightboxWrapper");if(this.lightboxWrapper.length===0){$("body").append('<div id="gumtree-GumLightboxWrapper" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; overflow:hidden; z-index:10; "><div id="gumtree-GumLightboxBgShim" style="position:absolute; top:0; left:0; width:100%; height:100%; overflow:hidden; "></div><div id="gumtree-GumLightbox"><div id="gumtree-GumLightboxClose">Close</div></div></div>');this.lightboxWrapper=$("#gumtree-GumLightboxWrapper")}this.lightboxSurround=$("#gumtree-GumLightbox");this.lightboxContents=$('<div class="gumtree-GumLightboxContents">');this.lightboxClose=$("#gumtree-GumLightboxClose");this.lightboxShim=$("#gumtree-GumLightboxBgShim");this.lightboxWrapper.bind("click",function(D){if((D.target==A.lightboxWrapper.get(0))||(D.target==A.lightboxShim.get(0))){gumtree.GumLightbox.active_lightbox.trigger.removeClass("active");gumtree.GumLightbox.active_lightbox.closeLightbox();D.preventDefault();D.stopImmediatePropagation()}});this.lightboxClose.bind("click",function(D){gumtree.GumLightbox.active_lightbox.trigger.removeClass("active");gumtree.GumLightbox.active_lightbox.closeLightbox();D.preventDefault();D.stopImmediatePropagation()});this.trigger.bind("click",function(D){A.trigger.addClass("active");A.openLightbox();D.preventDefault()})};gumtree.GumLightbox.prototype.openLightbox=function(){var A=gumtree.GumLightbox.active_lightbox=this,B=27;this.isAnimating=true;this.setupLightbox();this.lightboxWrapper.fadeIn(function(){A.isAnimating=false});$(document).one("click.GumLightbox keypress",function(C){if(C.keyCode===B){A.lightboxWrapper.trigger("click")}})};gumtree.GumLightbox.prototype.closeLightbox=function(){var A=gumtree.GumLightbox.active_lightbox;this.isAnimating=true;this.lightboxWrapper.fadeOut(function(){A.lightboxContents.detach();if(!A.persistContent){A.lightboxContents.html("")}A.isAnimating=false;gumtree.GumLightbox.active_lightbox=null})};gumtree.GumLightbox.prototype.setupLightbox=function(){var A=this;A.lightboxContents.css({width:"",height:""});A.lightboxSurround.css({marginLeft:"",marginTop:""});A.lightboxWrapper.get(0).className=A.wrapperClass;A.lightboxSurround.get(0).className=A.surroundClass+" loading";A.lightboxContents.addClass(A.contentsClass);A.lightboxClose.get(0).className=A.closeClass;A.lightboxContents.insertAfter($("#gumtree-GumLightboxClose"));if(A.lightboxContents.html()!=""){setTimeout(function(){A.onAttach()},0)}else{if(A.lightboxType==="ajax"){var B=A.trigger.attr("href");if(!B){B=A.trigger.data("href")}A.getAjaxContents(B+" "+A.targetAjaxElement)}else{if(A.lightboxType==="script"){A.getContentsFromScript()}}}};gumtree.GumLightbox.prototype.placeMe=function(){var F,G,D,E,C=gumtree.GumLightbox.active_lightbox,A=C.lightboxContents.width(),B=C.lightboxContents.height();C.lightboxSurround.get(0).className=C.lightboxSurround.get(0).className.split(" loading").join(" loaded");D=parseInt(C.lightboxContents.outerWidth(true));E=parseInt(C.lightboxContents.outerHeight(true));F=parseInt(C.lightboxContents.width());G=parseInt(C.lightboxContents.height());C.lightboxSurround.get(0).className=C.lightboxSurround.get(0).className.split(" loaded").join("");C.lightboxContents.width(A);C.lightboxContents.height(B);C.lightboxSurround.get(0).className=C.surroundClass+" animating";if(this.scrollContent){if(G>this.maxHeight){E=E<this.maxHeight?E:this.maxHeight;this.setScroll()}}C.lightboxContents.animate({width:F+"px",height:G+"px"},C.transitionSpeed);C.lightboxSurround.animate({marginLeft:-(D/2)+"px",marginTop:-(E/2)+"px"},C.transitionSpeed,function(){C.lightboxSurround.get(0).className=C.lightboxSurround.get(0).className.split(" animating").join(" loaded");C.lightboxContents.css({width:"auto",height:"auto"})})};gumtree.GumLightbox.prototype.onAttach=function(){this._onAttach();this.placeMe()};gumtree.GumLightbox.prototype.getAjaxContents=function(C){var B=this,D=C.toString(),E=[],A=false,F=(this.method=="POST")?$("form").serializeArray():null;E=D.split("#");if(E.length>2){A=true}this.lightboxContents.load(C,F,function(){var G,H;if(A){G=E[1].replace(/\s/,"");H=document.getElementById(G);if(H){H.id=""}window.location.hash=G;if(H){H.id=G}}B.onAttach()})};gumtree.GumLightbox.prototype.getContentsFromScript=function(C){var B=this;var A=this.htmlSourceScript.apply(this,[function(){setTimeout(function(){B.onAttach()},10)}])};gumtree.GumLightbox.active_lightbox=null;gumtree.GumFormGrid=function(O){if(!(this instanceof (gumtree.GumFormGrid))){return new gumtree.GumFormGrid(O)}var J=this,I=$(O.gridContainer),B=$(O.gridFieldset),P=O.gridError,F=$(O.gridSubmit),C=I.find(".grid-level-holder"),G=C.length,A=I.find(".form-hidden"),M=A.find('input[type="hidden"]'),R=O.onChangeHook||function(){},Q;var E=function(){return $(".leaf.selected")};var K=function(){return(E().length===1)};var L=function(){if(K()){M.attr("value",E().data("grid-id"));A.addClass("form-component-success");B.addClass("form-component-success")}else{M.attr("value","");A.removeClass("form-component-success");B.removeClass("form-component-success")}};F.bind("click",function(){if(!K()){F.closest(".form-component").addClass("form-component-error").find(".error").html(P)}});J.clickGrid=function(S,X,T){var T=T||$(S.target),V=(T.hasClass("sunset-text")||T.parents(".sunset-text").length)?"":(T.closest("a").attr("href")||T.find("a").attr("href"));F.closest(".form-component").removeClass("form-component-error").find(".error").html("");if(V){var U=T.closest("li");J.lastRequestedUrl=V;U.addClass("selected").removeClass("blurred");U.siblings().removeClass("selected").addClass("blurred");if(X<G){var Z=X+1,Y=X+1,W="grid-level-"+Z,a=".grid-level-"+Z+"-holder";if(!K()){$(".grid-level-"+Z+"-holder").addClass("loading")}while(Y<=G){$(".grid-level-"+Y+"-holder .grid-level").html("");Y++}if(Q){Q.abort()}Q=$.ajax({url:V,success:function(d){var c=d.indexOf(W)===-1,b=$("."+W);if(c){window.location.reload()}$(a).html($(d).find("."+W));L();b.hide();$(".grid-level-"+Z+"-holder").removeClass("loading");b.hide();b.fadeIn();R.apply(J,[d])},dataType:"html"})}else{L();gumtree.init.postAd.setContinueState()}S.preventDefault()}};var H=function(S){var T=parseInt($(S).data("grid-level"),10);$(S).bind("click",function(U){J.clickGrid(U,T)})};if(M.length===1){for(var N=0;N<G;N++){var D=$(C[N]);H(D)}}};gumtree.GumImageUploader=function(D){var B=this,E=$('input[name="mainImageId"]');if(!(this instanceof (gumtree.GumImageUploader))){return new gumtree.GumImageUploader(D)}this.rootHandlerPath="/postad/"+gumtree.state.editorId+"/images/";this.postImageComponentTrigger=D.postImageComponentTrigger;this.postImageComponentTriggerContainer=D.postImageComponentTriggerContainer;this.postImageComponent=D.postImageComponent,this.maxMediaPerAd=D.maxMediaPerAd,this.stateChangeCallback=D.stateChangeCallback||function(){},this.uploadedImages=[],this.failCount=0;for(var C=0,A=E.length;C<A;C++){this.uploadedImages.push(parseInt(E[C].value))}if(this.postImageComponentTrigger.length>0){var F=new plupload.Uploader({urlstream_upload:true,runtimes:"flash,html5,silverlight,gears,browserplus,html4",browse_button:"plupload-select_post-ad_image-upload-trigger",container:"image-upload-trigger-container",drop_element:"postad-form",max_file_size:"9mb",url:B.rootHandlerPath,flash_swf_url:"/common/plupload/plupload.flash.swf",silverlight_xap_url:"/common/plupload/plupload.silverlight.xap",filters:[{title:"Image files",extensions:"gif,jpg,jpeg,png,tif"}],resize:{width:1920,height:1080,quality:90}});this.postImageComponent.find(".remove-media").live("click",function(){var G=$(this).closest(".image-container"),H=G.find(".assign-as-main input").val();jQuery.getJSON(B.rootHandlerPath+"/delete/"+H,function(){G.fadeOut(function(){$(this).remove();B.setMainImageState();B.setAddButtonState();B.setRemainingIndicator();B.stateChangeCallback()})})});B.setMainImageState();B.setAddButtonState();B.setRemainingIndicator();F.bind("Refresh",function(G){$("#"+G.settings.container+" > div.plupload").css({left:0,top:0,width:"90px",height:"27px",cursor:"pointer"})});F.bind("Init",function(G,H){});F.bind("FileUploaded",function(G,H){B.showThumbnail($("#plupload_"+H.id))});$("#uploadfiles").click(function(G){F.start();G.preventDefault()});F.init();F.bind("FilesAdded",function(G,J){B.failCount=0;$(".form-image-upload label .error").removeClass("soft-error force-visible").html("");$(".form-image-upload label").parent(".form-component").removeClass("form-component-soft-error");var H=B.assignedMediaCount(),I=0;$.each(J,function(L,K){if(K.status===plupload.QUEUED){if(H<B.maxMediaPerAd){$('<li id="plupload_'+K.id+'" class="image-container loading"></li>').insertBefore(B.postImageComponentTriggerContainer);H++}else{F.removeFile(K)}}else{if(K.status===plupload.FAILED){B.failCount++;F.removeFile(K)}}});if(B.failCount>0){$(".form-image-upload label .error").html("<strong>Alert: </strong>"+B.failCount+((B.failCount>1)?" of the files were not valid and were":" file was not valid and was")+" not uploaded, only .jpg, .gif, .png, .tif files under 9mb will be accepted").addClass("soft-error force-visible");$(".form-image-upload label").parent(".form-component").addClass("form-component-soft-error")}B.setAddButtonState();B.setRemainingIndicator();F.refresh();F.start()});F.bind("Error",function(G,H){B.failCount++;$(".form-image-upload label .error").html("<strong>Alert: </strong>Some of the file(s) were not valid and were not uploaded, only .jpg, .gif, .png, .tif files under 9mb will be accepted").addClass("soft-error force-visible");$(".form-image-upload label").parent(".form-component").addClass("form-component-soft-error");B.setAddButtonState();B.setRemainingIndicator();G.refresh();B.stateChangeCallback()})}};gumtree.GumImageUploader.prototype.setAddButtonState=function(){if(this.maxMediaPerAd>this.assignedMediaCount()){this.postImageComponentTriggerContainer.css("visibility","visible")}else{this.postImageComponentTriggerContainer.css("visibility","hidden")}};gumtree.GumImageUploader.prototype.assignedMediaCount=function(){return $(".image-container").length};gumtree.GumImageUploader.prototype.setMainImageState=function(){var B=$('input[name="mainImageId"]'),C=$('label[for="mainImageId"]'),A=this;if(this.uploadedImages.length<2){C.hide();B.closest(".assign-as-main").hide()}else{if($('input[name="mainImageId"]:checked').length===0){$(B.get(0)).attr("checked","checked")}B.closest(".assign-as-main").show();$('input[name="mainImageId"]').unbind("change.GumImageUploader").bind("change.GumImageUploader",function(){A.postImageComponent.next('input[type="file"]').blur()});C.show()}};gumtree.GumImageUploader.prototype.setRemainingIndicator=function(){$(".upload-remaining-indicator").html(this.maxMediaPerAd-this.assignedMediaCount())};gumtree.GumImageUploader.prototype.showThumbnail=function(B){var A=this,C=gumtree.utils.inArray;$.ajax({url:A.rootHandlerPath,dataType:"json",success:function(F){for(var E=0,D=F.length;E<D;E++){var G=F[E];if(!C(G.id,A.uploadedImages)){B.removeClass("loading").addClass("loaded");B.data("eps-id",G.id);B.html('<img src="'+G.thumbnailUrl+'" /><div class="assign-as-main"><input type="radio" name="mainImageId" value="'+G.id+'" /></div><div class="remove-media">Remove</div>');B.attr("src",G.url);A.uploadedImages.push(G.id);$('<li><input type="radio" name="mainImageId" value="'+G.id+'" /></li>').appendTo($(".main-image-assign-wrapper"))}}A.setMainImageState();A.stateChangeCallback()},complete:function(D){if(D.statusText=="parsererror"){$(".form-image-upload label .error").html("<strong>Alert: </strong>Some of the file(s) were not valid and were not uploaded, only .jpg, .gif, .png, .tif files under 9mb will be accepted").addClass("soft-error force-visible");$(".form-image-upload label").parent(".form-component").addClass("form-component-soft-error")}}})};gumtree.GumMediaLinkUploader=function(D){if(!(this instanceof (gumtree.GumMediaLinkUploader))){return new gumtree.GumMediaLinkUploader(D)}var B=this,F=D.formComponent,E=D.labelVisible||false,A=B.input=F.find("input"),C=A.val();if(!A.length){return }B.showLink=function(){B.label.css("visibility","hidden");B.inputContainer.hide();B.link.show();B.imgContainer.hide()};B.showEditState=function(){B.link.hide();B.imgContainer.hide();B.label.css("visibility","visible");B.inputContainer.show();B.imgContainer.hide()};B.showThumbnail=function(){B.imgContainer.show();B.link.hide();B.label.css("visibility","visible");B.inputContainer.hide()};B.fetchThumbnail=function(){$.ajax({url:B.thumbnailPath,dataType:"text",success:function(H){var G=B.img.attr("src");if(H!=G){B.img.attr("src",H)}else{if(G!==""){B.showThumbnail()}}},error:function(){B.showError("Please enter a valid Youtube URL")}})};B.showError=function(G){F.removeClass("form-component-success").addClass("form-component-error");F.find(".error").html(G);B.showEditState()};B.label=F.find("label");B.inputContainer=F.find(".js_form-input");B.link=F.find(".non-label-text").addClass("media-link-action").click(B.showEditState);B.thumbnailPath="/postad/"+gumtree.state.editorId+"/form/youtube";B.img=$("<img />").error(function(){B.showError("Please enter a valid Youtube URL")}).load(function(){B.showThumbnail()});B.imgContainer=$("<div></div>").hide().addClass("thumbnail-container-droppable");F.append(B.imgContainer);B.imgContainer.append($("<div></div>").addClass("thumbnail-container").append(this.img).append($("<div></div>").addClass("remove-media").click(function(){B.input.val("");B.showLink()})));A.bind("validated",function(){B.fetchThumbnail.call(B)});if(C===""){if(E){B.showEditState()}else{B.showLink()}}else{B.fetchThumbnail()}};gumtree.GumAsyncFormValidation=function(B){if(!(this instanceof (gumtree.GumAsyncFormValidation))){return new gumtree.GumAsyncFormValidation(B)}var A=this,C=B.excludesClass||null;this.postValidationHook=B.postValidationHook||function(){};this.form=B.form;this.inputs=this.form.find("input[name][type=text], input[name][type=checkbox], input[name][type=file], input[name][type=hidden], input[name][type=image], input[name][type=password], input[name][type=radio], input[name][type=date], textarea[name], select[name]").filter(function(){if(C){return !$(this).parents(C).length}else{return true}}),this.handler=this.form.attr("action")+"?validate=true";this.inputs.each(function(){var D=$(this);D.bind("blur",function(E){A.requestValidation(D,E)})})};gumtree.GumAsyncFormValidation.prototype.requestValidation=function(F,C){var A=this,B=gumtree.utils.forms.serializeInputs,F=F||null,E,D=B(A.form.get(0),C);if(F){E=F.closest(".form-component")}if(!F||(F&&!E.hasClass("do-not-validate"))){$.ajax({url:A.handler,type:"POST",data:D,contentType:"application/x-www-form-urlencoded;charset=utf-8",dataType:"json",success:function(I){if(I.validation){if(F){A.processValidation(I,F,true)}else{var K=I.validation.components;for(var J=0,G=K.length;J<G;J++){var H=K[J];A.processValidation(I,$("[name='"+H.component+"']"),true)}}}A.postValidationHook()},complete:function(H,I){var G=H.responseText.substring(0,20).indexOf("validation")!==-1;if(I==="parsererror"||!G){if(!F){window.location.reload()}}}})}};gumtree.GumAsyncFormValidation.prototype.getValidation=function(E,B){var C="SUCCESS",I="",F=E.validation.components,H=B.attr("name");for(var D=0,A=F.length;D<A;D++){var G=F[D];if(G.component===H){C="FAILED",I=G.messages.join(", ")}}return{"status":C,"message":I}};gumtree.GumAsyncFormValidation.prototype.processValidation=function(D,F,C){var B=this;if(D.validation){var A=B.getValidation(D,F);if(B.showValidationResult(F,A)){if(C&&F.data("siblings")){var E=$(F.data("siblings"));E.each(function(){var G=$(this);if(G!=B){B.processValidation(D,G,false)}})}}}};gumtree.GumAsyncFormValidation.prototype.showValidationResult=function(H,A){var D=H.closest(".form-component"),C=H.parents("fieldset.form-composite"),B=D.find(".error");if(A.status==="FAILED"){D.removeClass("form-component-success").addClass("form-component-error");B.html(A.message);if(C.length>0){C.addClass("form-component-error").removeClass("form-component-success")}return false}else{if(A.status==="SUCCESS"){D.removeClass("form-component-error").addClass("form-component-success");B.html("");if(C.length>0){var G=C.find(".form-component-mandatory").length,F=C.find(".form-component-mandatory.form-component-success").length,E=C.find(".form-component-error").length;if(!E){C.removeClass("form-component-error")}if(F===G){C.addClass("form-component-success")}}H.trigger("validated");return true}}};(function(D){var B="ar"+ +new Date,E=C.defaults={onResize:function(){},onBeforeResize:function(){return 123},onAfterResize:function(){return 555},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};C.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","paddingTop","paddingLeft","paddingBottom","paddingRight","width"];C.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden"};C.resizableFilterSelector=["textarea:not(textarea."+B+")","input:not(input[type])","input[type=text]","input[type=password]","input[type=email]","input[type=url]"].join(",");C.AutoResizer=A;D.fn.autoResize=C;function C(F){this.filter(C.resizableFilterSelector).each(function(){new A(D(this),F)});return this}function A(G,F){if(G.data("AutoResizer")){G.data("AutoResizer").destroy()}F=this.config=D.extend({},C.defaults,F);this.el=G;this.nodeName=G[0].nodeName.toLowerCase();this.originalHeight=G.height();this.previousScrollTop=null;this.value=G.val();if(F.maxWidth==="original"){F.maxWidth=G.width()}if(F.minWidth==="original"){F.minWidth=G.width()}if(F.maxHeight==="original"){F.maxHeight=G.height()}if(F.minHeight==="original"){F.minHeight=G.height()}if(this.nodeName==="textarea"){G.css({resize:"none",overflowY:"hidden"})}G.data("AutoResizer",this);F.animate.complete=(function(H){return function(){F.onAfterResize.call(G);return H.apply(this,arguments)}}(F.animate.complete));this.bind()}A.prototype={bind:function(){var F=D.proxy(function(){this.check();return true},this);this.unbind();this.el.bind("keyup.autoResize",F).bind("change.autoResize",F).bind("paste.autoResize",function(){setTimeout(function(){F()},0)});if(!this.el.is(":hidden")){this.check(null,true)}},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var F=this.el,G=this.nodeName==="textarea"?F.clone():D("<span/>");this.clone=G;D.each(C.cloneCSSProperties,function(H,I){G[0].style[I]=F.css(I)});G.removeAttr("name").removeAttr("id").addClass(B).attr("tabIndex",-1).css(C.cloneCSSValues);if(this.nodeName==="textarea"){G.height("auto")}else{G.width("auto").css({whiteSpace:"nowrap"})}},check:function(L,J){if(!this.clone){this.createClone();this.injectClone()}var I=this.config,M=this.clone,H=this.el,N=H.val();if(N===this.prevValue){return true}this.prevValue=N;if(this.nodeName==="input"){M.text(N);var O=M.width(),K=(O+I.extraSpace)>=I.minWidth?O+I.extraSpace:I.minWidth,G=H.width();K=Math.min(K,I.maxWidth);if((K<G&&K>=I.minWidth)||(K>=I.minWidth&&K<=I.maxWidth)){I.onBeforeResize.call(H);I.onResize.call(H);H.scrollLeft(0);if(I.animate&&!J){H.stop(1,1).animate({width:K},I.animate)}else{H.width(K);I.onAfterResize.call(H)}}return }M.width(H.width()).height(0).val(N).scrollTop(10000);var F=M[0].scrollTop;if(this.previousScrollTop===F){return }this.previousScrollTop=F;if(F+I.extraSpace>=I.maxHeight){H.css("overflowY","");F=I.maxHeight;J=true}else{if(F<=I.minHeight){F=I.minHeight}else{H.css("overflowY","hidden");F+=I.extraSpace}}I.onBeforeResize.call(H);I.onResize.call(H);if(I.animate&&!J){H.stop(1,1).animate({height:F},I.animate)}else{H.height(F);I.onAfterResize.call(H)}},destroy:function(){this.unbind();this.el.removeData("AutoResizer");this.clone.remove();delete this.el;delete this.clone},injectClone:function(){(C.cloneContainer||(C.cloneContainer=D("<arclones/>").appendTo("body"))).append(this.clone)}}})(jQuery);BrowserPlus=(typeof BrowserPlus!="undefined"&&BrowserPlus)?BrowserPlus:(function(){var W=false;var g="__browserPlusPluginID";var h="uninitialized";var f=[];var R="application/x-yahoo-browserplus_2";var c,b,a,e,U;return{initWhenAvailable:function(B,A){setTimeout(function(){try{navigator.plugins.refresh(false)}catch(C){}BrowserPlus.init(B,function(D){if(D.success){A(D)}else{BrowserPlus.initWhenAvailable(B,A)}})},1000)},clientSystemInfo:function(){return d()},listActiveServices:function(A){if(A==null||A.constructor!=Function){throw new Error("BrowserPlus.services() invoked without  required callback parameter.")}return Y().EnumerateServices(A)},getPlatformInfo:function(){if(Y()===null){throw new Error("BrowserPlus.getPlatformInfo() invoked, but init() has not completed successfully.")}return Y().Info()},isServiceLoaded:function(A,B){return((A!=undefined&&BrowserPlus.hasOwnProperty(A))&&(B==undefined||BrowserPlus[A].hasOwnProperty(B)))},describeService:function(A,B){if(B==null||B.constructor!=Function){throw new Error("BrowserPlus.services() invoked without  required callback parameter")}if(Y()===null){throw new Error("BrowserPlus.describeService() invoked, but init() has not completed successfully.")}return Y().DescribeService(A,B)},isServiceActivated:function(A,B){return Y().DescribeService(A,(function(){var C=B;return function(D){C(D.success)}})())},isInitialized:function(){return(h==="succeeded")},require:function(B,A){if(A==null||A.constructor!=Function){throw new Error("BrowserPlus.require() invoked without required callback parameter")}var C=function(E){if(E.success){var D=[];for(var F=0;F<E.value.length;F++){if(E.value[F].fullDesc){Z({value:E.value[F].fullDesc});D.push({service:E.value[F].service,version:E.value[F].version})}else{BrowserPlus.describeService({service:E.value[F].service,version:E.value[F].version},Z);D=E.value}}E.value=D}A(E)};Y().RequireService(B,C);return true},init:function(D,E){if(d().browser=="Safari"){navigator.plugins.refresh(false)}var G=null;var A=null;if(E==null){A=D}else{G=D;A=E}if(A==null||A.constructor!=Function){throw new Error("BrowserPlus.init() invoked without  required callback parameter")}if(G===null){G=new Object}if(typeof (G.locale)=="undefined"){G.locale=d().locale}var F=true;if(!G.supportLevel||G.supportLevel==="experimental"){F=(d().supportLevel!=="unsupported")}else{if(G.supportLevel==="supported"){F=(d().supportLevel==="supported")}}if(!F){A({success:false,error:"bp.unsupportedClient"});return }if(h==="succeeded"){A({success:true});return }if(h=="inprogress"){f.push(A);return }h="inprogress";if(typeof (window.onunload)=="undefined"){window.onunload=function(){}}var B=false;if(V()&&Y()!==null){B=true}if(!B){h="uninitialized";A({success:false,error:"bp.notInstalled"});return }else{f.push(A);var C=(function(){var H=G;return function(){var L=function(O){if(!O.success&&O.error==="bp.switchVersion"&&d().browser!=="Explorer"){var N="application/x-yahoo-browserplus_";N+=O.verboseError;if(N!==R){R=N;setTimeout(function(){try{var k=document.getElementById(g);if(k){document.documentElement.removeChild(k.parentNode)}navigator.plugins.refresh(false)}catch(l){}if(V()&&Y()!==null){setTimeout(function(){Y().Initialize(H,L)},10)}else{L(O)}},10);return }}if(!O.success&&O.error==="bp.switchVersion"){O={success:false,error:"bp.notInstalled",verboseError:"BrowserPlus isn't installed, or couldn't be loaded"}}h=O.success?"succeeded":"uninitialized";var Q=f;f=[];for(var P=0;P<Q.length;P++){Q[P](O)}};try{Y().Initialize(H,L)}catch(I){var K=d();var M={success:false,error:"bp.notInstalled",verboseError:String(I)};if(K.browser=="Explorer"){M.error="bp.unsupportedClient"}else{if(K.browser=="Firefox"){try{navigator.plugins.refresh(true)}catch(J){}}}L(M)}}})();setTimeout(C,0)}},_detectBrowser:function(){return BrowserPlus.clientSystemInfo()}};function V(){if(T()){return S()}else{return X()}}function X(){var B=navigator.mimeTypes[R];if(typeof (B)!=="object"||typeof (B.enabledPlugin)!=="object"){return false}var A=document.createElement("div");A.style.visibility="hidden";A.style.borderStyle="hidden";A.style.width=0;A.style.height=0;A.style.border=0;A.style.position="absolute";A.style.top=0;A.style.left=0;A.innerHTML='<object type="'+R+'" id="'+g+'" name="'+g+'"></object>';document.documentElement.appendChild(A);W=true;return true}function S(){if(Y()!=null){return true}try{var C=document.createElement("object");C.id=g;C.type=R;C.style.display="none";document.body.appendChild(C);document.getElementById(g).Ping();W=true;return true}catch(A){try{document.body.removeChild(C)}catch(B){}}return false}function Y(){if(W){return document.getElementById(g)}return null}function T(){return(d().browser=="Explorer")}function Z(D){D=D.value;var B=D.name;var F=D.versionString;if(!BrowserPlus[B]){BrowserPlus[B]={};BrowserPlus[B].corelet=B;BrowserPlus[B].version=F}if(!BrowserPlus[B][F]){BrowserPlus[B][F]={};BrowserPlus[B][F].corelet=B;BrowserPlus[B][F].version=F}if(B=="core"){BrowserPlus[B].version=F}if(D.functions){for(var E=0;E<D.functions.length;E++){var A=D.functions[E].name;var C=(function(){var G=A;return function(H,I){if(I==null||I.constructor!=Function){throw new Error("BrowserPlus."+B+"."+G+"() invoked without  required callback parameter")}return Y().ExecuteMethod(B,F,G,H,I)}})();BrowserPlus[B][F][A]=C;if(F==BrowserPlus[B].version){BrowserPlus[B][A]=C}}}}function d(){var G=[{string:navigator.vendor,subString:"Apple",identity:"Safari"},{string:navigator.vendor,subString:"Google",identity:"Chrome"},{prop:window.opera,identity:"Opera"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}];var A=[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}];var C={Mac:{Firefox:"supported",Safari:"supported"},Windows:{Explorer:{"8":"supported","7":"supported","6":"experimental"},Safari:"supported",Firefox:"supported",Chrome:"supported"}};var E;function D(H){for(var K=0;K<H.length;K++){var J=H[K].string;var I=H[K].prop;E=H[K].versionSearch||H[K].identity;if(J){if(J.indexOf(H[K].subString)!=-1){return H[K].identity}}else{if(I){return H[K].identity}}}return null}function F(H){var I=H.indexOf(E);if(I==-1){return null}else{return parseFloat(H.substring(I+E.length+1))}}function B(){if(C[a]&&C[a][c]){var H=C[a][c];if(typeof H==="string"){return H}else{if(H[b]){return H[b]}else{return"unsupported"}}}else{return"unsupported"}}if(!c){c=D(G)||"An unknown browser";b=F(navigator.userAgent)||F(navigator.appVersion)||"an unknown version";a=D(A)||"an unknown OS";if(a==="Mac"&&navigator.userAgent.indexOf("Intel")==-1){U="unsupported"}else{if(navigator.userAgent.indexOf("Firefox/2.0.0")!=-1){U="unsupported"}else{U=B()}}e=navigator.language||navigator.browserLanguage||navigator.userLanguage||navigator.systemLanguage}return{browser:c,version:b,os:a,locale:e,supportLevel:U}}})();if(typeof YAHOO=="undefined"||!YAHOO){var YAHOO={}}if(typeof YAHOO.bp=="undefined"||!YAHOO.bp){YAHOO.bp=BrowserPlus}gumtree.init.postAd.isOnConfirmationPage=function(){var A=$("#post-ad_submit-features-confirmation").attr("id");if(A!=undefined){return true}return false};gumtree.init.postAd.formMerger=function(){if(gumtree.init.postAd.isOnConfirmationPage()==true){return false}var C=".form-flow-mergable",E=gumtree.utils.get(C,"form",document.getElementById("main")),F=[document.getElementById("post-ad_submit-new-advert-data"),document.getElementById("post-ad_submit-preview-advert-data")];for(var D=0,A=E.length;D<A;D++){var B=new gumtree.GumFormMergable({"form":E[D],"formHolderClass":C,"excludes":F,"onChangeHook":function(G){$(".notice.failure").remove()}})}};gumtree.init.postAd.setContinueState=(function(){if(gumtree.init.postAd.isOnConfirmationPage()==true){return false}var B=$(".form-state-warning"),A=$(".form-flow-mergable").length;if(A){if(!gumtree.state.postAdFormContinueContainer){gumtree.state.postAdFormContinueContainer=new gumtree.GumFormContinueContainer({"continueContainer":$(".submit-button-wrapper"),"continueButtons":".button"})}else{gumtree.state.postAdFormContinueContainer.initialise()}if(B.length>0){$(window).unbind("scroll.continueVisibleEagerValidate").bind("scroll.continueVisibleEagerValidate",function(){if(!gumtree.state.postAdFormContinueContainer.isContinuable()){var C=gumtree.utils.get(".submit-button-wrapper-placeholder")[0];if(gumtree.utils.isElementInViewport(C)){$(".form-component-mandatory").each(function(){var F=!$(this).hasClass("form-component-success"),D=$(this).hasClass("form-component-error"),E=$(this).find("input"),G=$(this).find("textarea");if(F){if(E.data("blurred")||G.data("blurred")){if(D){E.blur();G.blur()}}else{E.blur().data("blurred","true");G.blur().data("blurred","true")}}})}}})}}});gumtree.init.postAd.setupAsyncFormValidation=function(){var A=gumtree.utils.get(".submit-button-wrapper-placeholder")[0],B=gumtree.utils.get(".submit-button-wrapper")[0];gumtree.state.mergedFormSubmits=[];$('#main form input[type="radio"],#main form input[type="checkbox"]').change(function(){$(this).trigger("blur")});$("#post-ad_feature_SPOTLIGHT_selected").bind("change",function(){var C=$(this);if(C.attr("checked")){C.closest(".form-component").addClass("form-component-mandatory")}else{C.closest(".form-component").removeClass("form-component-mandatory")}});if(gumtree.init.postAd.isOnConfirmationPage()==true){return false}$("#main form").each(function(){gumtree.state.mergedFormSubmits.push(new gumtree.GumAsyncFormValidation({"form":$(this),"excludesClass":".form-component.js_no-validate","postValidationHook":function(){gumtree.init.postAd.setContinueState();gumtree.init.postAd.autoCompleteContactFields();gumtree.init.postAd.setContactNamePadding();if(gumtree.utils.isElementInViewport(A)||$(B).hasClass("form-continuable")){var D=$(".form-state-warning"),E=gumtree.state.postAdFormContinueContainer.isContinuable();if(D.length>0){var C=(D.text().length!=0);if(!E&&!C){D.text("Almost there, but it looks like you've missed something?")}else{if((E)||(E&&C)){D.text("")}}}}}}))});$("form .button").unbind("mouseenter.focusButtonOnRoll").bind("mouseenter.focusButtonOnRoll",function(){$(this).trigger("focus");$(this).trigger("blur")})};gumtree.init.postAd.setupGrids=(function(){var A=new gumtree.GumFormGrid({gridFieldset:$("fieldset.category-select"),gridContainer:$("fieldset.category-select .form-component.form-grid"),gridSubmit:"#category-select_submit-category",gridError:"Please select the lowest level category for your ad before continuing",gridSubmitFormComponent:".post-ad-next-step .form-component",onChangeHook:function(C){var B=$(C).find("#category-terms-required");$("#category-terms-required").remove();if(B.length>0){B.insertAfter($("#post-ad-category-select"))}gumtree.state.categoryTermsLightbox.setState();gumtree.init.global.doFormInputWrappers();gumtree.init.global.doFormPlaceholders();gumtree.init.global.formInputClearControls();gumtree.init.postAd.setContinueState();$(".grid-category-link").click(function(D){var E=$(this);A.clickGrid(D,parseInt(E.attr("grid-item-level"),10),$(E.attr("grid-item-selector")))})}});new gumtree.GumFormGrid({gridFieldset:$("fieldset.location-select"),gridContainer:$("fieldset.location-select .form-component.form-grid"),gridError:"Please select the lowest level location for your ad before continuing",gridSubmit:"#location-select_location_continue",gridSubmitFormComponent:".post-ad-next-step .form-component",onChangeHook:function(C){var B=$(C).find(".location-other");if(B.length>0){$("fieldset.location-select").find(".location-other").remove();$("fieldset.location-select").append(B)}else{$("fieldset.location-select").find(".location-other").remove()}gumtree.init.global.doFormInputWrappers();gumtree.init.global.doFormPlaceholders();gumtree.init.global.formInputClearControls();gumtree.init.postAd.setContinueState()}})});gumtree.init.postAd.categoryTermsLightbox=(function(){this.setState=function(){var A=$("form #category-terms-required").clone(true);if(A.find(".form-component-error").length===1){var B=$("#js_category-terms-required-trigger");B.remove();if(B.length===0){$("body").append('<a id="js_category-terms-required-trigger"></a>');B=$("#js_category-terms-required-trigger");this.categoryTermsLightboxContainer=new gumtree.GumLightbox({trigger:B,lightboxType:"script",htmlSourceScript:function(H){var C=this.lightboxContents,F,D,G,E;C.append(A);C.find("input").attr("id","js_dynamic-termsAgreed").attr("name","js_dynamic-termsAgreed");C.find("label").attr("for","js_dynamic-termsAgreed");if(C.find("fieldset .button").length===0){C.find("fieldset").append('<a id="js_category-terms-required-submit" class="button">Continue</a>');F=C.find("fieldset .button");D=C.find("fieldset input");G=$('input[name="termsAgreed"]');E=C.find("fieldset .error");D.unbind("change.dynamicTermsAgreedCheck").bind("change.dynamicTermsAgreedCheck",function(I){I.preventDefault();G.attr("checked",D.attr("checked"))});F.unbind("click.dynamicTermsAgreedCheck").bind("click.dynamicTermsAgreedCheck",function(I){if(!G.attr("checked")){E.show()}else{E.hide();$("#gumtree-GumLightboxClose").trigger("click");$("#category-select_submit-category").trigger("click")}I.preventDefault()})}setTimeout(function(){H()},10)},wrapperClass:"lightbox-wrapper",surroundClass:"lightbox-holder",contentsClass:"lightbox-contents lightbox-contents-category-terms",closeClass:"lightbox-close",onAttach:function(){gumtree.utils.onDomChange()}});B.trigger("click")}}};this.setState();gumtree.state.categoryTermsLightbox=this});gumtree.init.postAd.mediaUploader=function(){new gumtree.GumMediaLinkUploader({formComponent:$("#post-ad__fieldset_attributes_media .form-text"),labelVisible:true});var A=gumtree.init.global.isMobile();if(A.noFileBrowse){$(".ios-error, #ios-warning").show();$("#plupload-container_post-ad_image-select").addClass("ios");return }new gumtree.GumImageUploader({postImageComponentTrigger:$("#plupload-select_post-ad_image-select"),postImageComponentTriggerContainer:$("#image-upload-trigger-container"),postImageComponent:$("#plupload-container_post-ad_image-select"),maxMediaPerAd:gumtree.settings.maxMediaPerAd||9,stateChangeCallback:function(){var D=$("#plupload-select_post-ad_image-select"),C=D.closest(".form-component form-image-upload"),B=$(".image-container").length;$(".non-js_post-ad_image-select").show().trigger("blur").hide();$("#post-ad_feature_SPOTLIGHT_selected").trigger("blur");if(B>0){D.text("Add more")}else{D.text("Add image")}}})};gumtree.init.postAd.previewLightbox=function(){$("#post-ad_submit-preview-advert-data").each(function(){var A=new gumtree.GumLightbox({method:"POST",trigger:$(this),wrapperClass:"lightbox-wrapper",surroundClass:"lightbox-holder",contentsClass:"lightbox-contents ad-preview-lightbox",closeClass:"lightbox-close",targetAjaxElement:"#main",onAttach:function(){if(window.innerShiv){var D=this.lightboxContents.html();this.lightboxContents.get(0).innerHTML="";this.lightboxContents.get(0).appendChild(innerShiv(D))}var J=(this.lightboxContents).find("#main"),F=J.find(".vip-blocker"),G=J.find(".vip-wrapper"),C=J.find("#post-ad_edit-ad"),I=J.find("#post-ad_submit-new-advert-data"),B=G.height(),H=(C.length>0&&I.length>0),E=J.find("a.open_map");E.show();J.attr("id","lightbox-main");if(!H){J.html('<div class="ad-preview-error"><h1>Cannot preview ad</h1><p>Sorry, the advert is not in a state that can be previewed, please complete all mandatory fields before attempting to preview your ad.</p></div>')}else{C.bind("click",function(){$("#gumtree-GumLightboxClose").trigger("click");return false});I.bind("click",function(){$("#main .post-ad-form-flow form").trigger("submit");return false});G.css("height","auto");F.height(G.height());G.css("height",B+"px");gumtree.thirdparty.analytics.events.PostAdPreview()}}})})};gumtree.init.postAd.deleteAdLightbox=function(){$(".delete-ad").each(function(){var A=new gumtree.GumLightbox({trigger:$(this),wrapperClass:"lightbox-wrapper",surroundClass:"lightbox-holder",contentsClass:"lightbox-contents ad-delete-lightbox",closeClass:"lightbox-close",targetAjaxElement:"#main",onAttach:function(){var C=(this.lightboxContents).find("#main"),B=C.find(".js_cancel-delete");C.attr("id","lightbox-main");B.bind("click",function(){$("#gumtree-GumLightboxClose").trigger("click");return false})}})})};gumtree.init.postAd.featureLightboxes=function(){$(".feature-example").each(function(){var A=new gumtree.GumLightbox({trigger:$(this),wrapperClass:"lightbox-wrapper",surroundClass:"lightbox-holder",contentsClass:"lightbox-contents",closeClass:"lightbox-close",targetAjaxElement:"#main",onAttach:function(){var B=(this.lightboxContents).find("#main");B.attr("id","lightbox-main")}})})};gumtree.init.postAd.maxLengthDescription=(function(){var A=$("#post-ad_description");A.bind("keydown keyup blur",function(D){var C=$(this),B=C.attr("maxlength"),E=C.val();if(E.length>B){C.val(E.substr(0,B))}})});gumtree.init.postAd.maxLengthIndicator=(function(){var A=$("form input[maxlength],form textarea[maxlength]");A.each(function(){var E=this,D=$(this),F=$(D.closest(".form-component").find(".maxlength-indicator")),C=$(F.find("span")),B=D.attr("maxLength");E.reset=function(){D.val("");C.html(B);F.removeClass("limit-reached")};D.bind("keydown keyup blur",function(H){var G=(B-$(E).val().length);if(G===0){F.addClass("limit-reached")}else{if(G>0){F.removeClass("limit-reached")}else{F.addClass("limit-reached")}}C.html(G)})})});gumtree.init.postAd.preventEnterSubmit=function(){var C=$("#main form"),D=[],B=C.find('input[type="text"],input[type="password"]'),A=B.filter(function(){return(!gumtree.utils.inArray(this,D))});A.bind("keydown",function(G){var F=G||window.event,E=F.keyCode||F.which||F.charCode;if(E==13){F.cancelBubble=true;F.returnValue=false;if($(G.target).data("trigger-submit")){$($(G.target).data("trigger-submit")).trigger("click")}if(F.stopPropagation){F.stopPropagation();F.preventDefault();F.preventDefault()}return false}})};gumtree.init.postAd.autoResizeDescription=(function(){var A=$("#post-ad_description"),B=$("#post-ad__fieldset_attributes_description span.error");A.autoResize({maxHeight:10000,onResize:function(C){B.css("top",(A.height()+25)+"px")}})});gumtree.init.postAd.linkedUrgentTrigger=function(){var H=$("#post-ad_feature_URGENT_selected, #post-ad_feature_URGENT_owned").parent(".form-checkbox"),F=$("#linked-urgent-flag").length,L,A,J,K="",D,C,E,G=false;if(!F){D=H.clone(true);A=H.parent("li").find(".feature-price-display").text().replace(/^\s\s*/,"").replace(/\s\s*$/,"");if(A){J=A.split("- ");C=J[1].split("£");if(C.length>2){G=true;E='<span class="undiscounted-price">£'+C[1]+'</span><span class="discounted-price">£'+C[2]+"</span>";var I=$(D.find("label"));I.html(I.html().replace(", rent or hire",""))}else{E=J[1]}K=(J.length>1)?"<strong>"+E+"</strong> for "+J[0]+" - ":"<strong>"+A+"</strong> - ";$("<span>"+K+"</span>").insertAfter(D.find("h3"))}L=D.find("input");L.removeAttr("name").attr("id","linked-urgent-flag");D.addClass("ad-feature").removeClass("form-component-mandatory");if(G){L.before('<div class="discount-sale-highlight"><h2><span>SALE</span></h2></div>');D.addClass("urgent-clone-padded")}$("#post-ad__fieldset_title").append(D)}var M=$("#linked-urgent-flag"),B=$("#post-ad_feature_URGENT_selected");M.unbind("click.linkedUrgentTrigger").bind("click.linkedUrgentTrigger",function(N){if(B.attr("checked")=="checked"){B.removeAttr("checked")}else{B.attr("checked","checked")}B.change()});B.unbind("change.linkedUrgentTrigger").bind("change.linkedUrgentTrigger",function(N){if(B.attr("checked")=="checked"){M.attr("checked","checked")}else{M.removeAttr("checked")}})};gumtree.init.postAd.linkedUrlTrigger=function(){var F=$("#post-ad_feature_WEBSITE_URL_selected, #post-ad_feature_WEBSITE_URL_owned"),G=F.parent(".form-checkbox"),E=G.find("input"),C=G.find("label[for=post-ad_feature_WEBSITE_URL_selected],label[for=post-ad_feature_WEBSITE_URL_owned]").text(),D=$("#linked-url-flag").length,B,A;if(!D){B=E.clone(true);B.removeAttr("name").attr("id","linked-url-flag");A=$("#post-ad__fieldset_websiteUrl");B.addClass("ad-feature");A.find("label[for=post-ad_websiteUrl]").html(B).append('<span class="error"></span>').append(C);F.closest("li").hide()}var H=$("#linked-url-flag");H.attr("clientValue",$("#post-ad_websiteUrl").attr("clientValue"));H.unbind("click.linkedUrlTrigger").bind("click.linkedUrlTrigger",function(I){F.attr("checked",!F.attr("checked"));F.trigger("change")});F.unbind("change.linkedUrlTrigger").bind("change.linkedUrlTrigger",function(I){H.attr("checked",F.attr("checked"))})};gumtree.init.postAd.checkUrlFeatureOnKeyDown=function(){var A=$("#linked-url-flag"),B=$("#post-ad_feature_WEBSITE_URL_selected, #post-ad_feature_WEBSITE_URL_owned");$("#post-ad_websiteUrl").bind("keydown keyup",function(D){var C=$(this),E=C.val();if(E.length>0){if(A.attr("checked")!="checked"){B.attr("checked","checked");A.attr("checked","checked").trigger("change")}}else{if(A.attr("checked")=="checked"){B.removeAttr("checked");A.removeAttr("checked").trigger("change")}}})};gumtree.init.postAd.checkUrlFeatureOnChange=function(){$("#linked-url-flag").live("change",function(C){var B=$(this),A=B.attr("checked"),D=$("#post-ad_websiteUrl");if(A){D.focus()}else{D[0].reset();D.focus();setTimeout(function(){D.blur()},100)}})};gumtree.init.postAd.vrnPromptFlow=function(){var A=$(".auto-attributes-manual-cta"),C=$(".auto-attributes-vrn-cta"),B;if(A.length>0){B=A.closest("fieldset.form-composite");A.bind("click",function(){B.removeClass("suppress-manual-vehicle-attributes")});C.bind("click",function(){B.addClass("suppress-manual-vehicle-attributes")})}};gumtree.init.postAd.contactMethodEnforcement=function(){var I=$("#post-ad_useEmail"),B=I.parent(".form-component"),A=B.next(".form-component"),D=$("#post-ad_usePhone"),F=D.parent(".form-component"),E=F.next(".form-component"),C=$("#post-ad_useUrl"),H=C.parent(".form-component"),J=H.next(".form-component"),G=function(L,K){if(I.attr("checked")!==true&&D.attr("checked")!==true&&C.attr("checked")!==true){B.addClass("form-component-mandatory");F.removeClass("form-component-mandatory");H.removeClass("form-component-mandatory")}else{B.removeClass("form-component-mandatory");F.removeClass("form-component-mandatory");H.removeClass("form-component-mandatory")}if(I.attr("checked")===true){A.addClass("form-component-mandatory")}else{A.removeClass("form-component-mandatory")}if(D.attr("checked")===true){E.addClass("form-component-mandatory")}else{E.removeClass("form-component-mandatory")}if(C.attr("checked")===true){J.addClass("form-component-mandatory")}else{J.removeClass("form-component-mandatory")}if(L&&K){var M=$(L.currentTarget);if($(M).attr("checked")===true){M.parent(".form-component").next(".form-component").find("input").trigger("focus")}}};if(I.length>0){I.unbind("click.contactMethodEnforcement").bind("click.contactMethodEnforcement",function(K){G(K,true)});D.unbind("click.contactMethodEnforcement").bind("click.contactMethodEnforcement",function(K){G(K,true)});C.unbind("click.contactMethodEnforcement").bind("click.contactMethodEnforcement",function(K){G(K,true)});G(null,false)}};gumtree.init.postAd.datePickers=function(){$(".form-component.form-date input").each(function(){var A=$(this);$(this).datepicker({dateFormat:"dd/mm/yy",beforeShow:function(){$("div.plupload").hide()},onClose:function(){$("div.plupload").show();A.trigger("blur")}})})};gumtree.init.postAd.autoCompleteContactFields=function(){var A=[{sourceField:"#post-ad_telephoneNumber",targetField:"#post-ad_contactTelephone"},{sourceField:"#post-ad_firstName",targetField:"#post-ad_contactName"}],F,D,E,C;gumtree.state.autoCompletedContactFields=!gumtree.state.autoCompletedContactFields?[]:gumtree.state.autoCompletedContactFields;for(var B=0;B<A.length;B++){D=$(A[B].sourceField);E=$(A[B].targetField);F=D.parents(".form-component-success").length;if(F&&!gumtree.state.autoCompletedContactFields[B]){C=D.val();E.val(C);gumtree.state.mergedFormSubmits[0].requestValidation(E);E.next(".pseudo-placeholder").hide();gumtree.init.global.formInputClearControls();gumtree.state.autoCompletedContactFields[B]=true}}};gumtree.init.postAd.setContactNamePadding=function(){contactPhoneHasError=$(".contact-phone.form-component-error").length>0;if(contactPhoneHasError){$(".contact-name").addClass("sibling-has-error")}else{$(".contact-name").removeClass("sibling-has-error")}};gumtree.init.postAd.listenToClearEvent=function(){$("#post-ad_websiteUrl").bind("onClear",function(){$(this).trigger("keydown")})};gumtree.init.postAd.promoteAddListener=function(){var A=$("#post-ad_submit-features-confirmation");A.attr("disabled","disabled");A.addClass("disabled");promoteAddToggler=function(){var B=0;$('#postad-form [id^="feature_"]:checked').each(function(){B++});if(B>0){A.removeAttr("disabled");A.removeClass("disabled")}else{A.attr("disabled","disabled");A.addClass("disabled")}};if(gumtree.init.postAd.isOnConfirmationPage()==true){$('#postad-form [id^="feature_"]').click(function(){promoteAddToggler()});$("#_select-all-features").bind("onSelectAll onUnselectAll",function(){promoteAddToggler()})}};gumtree.init.postAd.displayTotalPrice=function(){var A=$("#post-ad-total"),C=$("#linked-url-flag, #post-ad_feature_URGENT_selected, #feature_URGENT_selected, #post-ad_feature_FEATURED_selected, #feature_FEATURED_selected, #post-ad_feature_SPOTLIGHT_selected, #feature_SPOTLIGHT_selected, #post-ad_feature_FEATURED_productName, #feature_FEATURED_productName"),E=A.attr("totalLabel")+" &pound;",D=A.attr("includedInPackageLabel"),F=parseFloat(A.attr("insertionPrice")),B=function(){var G=F;C.each(function(){if(this.checked){if(this.id=="post-ad_feature_FEATURED_selected"){G+=parseFloat($("#post-ad_feature_FEATURED_productName option:selected").attr("clientValue"))}else{if(this.id=="feature_FEATURED_selected"){G+=parseFloat($("#feature_FEATURED_productName option:selected").attr("clientValue"))}else{if(this.id!="post-ad_feature_FEATURED_productName"&&this.id!="feature_FEATURED_productName"){G+=parseFloat($(this).attr("clientValue"))}}}}if(this.id=="feature_FEATURED_selected"){$("#featured-price").html("&pound;"+parseFloat($("#feature_FEATURED_productName option:selected").attr("clientValue")).toFixed(2))}});if(G==0&&D!=""){A.html(D);A.attr("total",0)}else{A.attr("total",G);A.html(E+G.toFixed(2))}};C.change(B);B()};gumtree.init.postAd.addDescriptionTextPointer=function(){$(".fieldset-hint").append('<div class="pointer">&nbsp;</div>')};gumtree.init.postAd.onFormSubmit=function(){$("#main .post-ad-form-flow form").submit(function(){if($("#post-ad-total").attr("total")==0){gumtree.thirdparty.analytics.events.PostAdFreeAttempt()}})};gumtree.init.postAd.setupDiscountedFeaturedSelect=function(){var F=$("#post-ad_feature_FEATURED_productName"),E=F.children(),A=E.length,D,B,G,C=function(){F[0].title=F.find("option:selected")[0].title};for(D=0;D<A;++D){G=E[D];B=G.text.split("£");if(B.length>2){G.title="Reduced from £"+B.splice(1,1);G.text=B.join("£")}F.on("change",C);C()}};(function(B,A){function C(E){return !B(E).parents().andSelf().filter(function(){return B.curCSS(this,"visibility")==="hidden"||B.expr.filters.hidden(this)}).length}function D(E,J){var I=E.nodeName.toLowerCase();if("area"===I){var H=E.parentNode,G=H.name,F;if(!E.href||!G||H.nodeName.toLowerCase()!=="map"){return !1}F=B("img[usemap=#"+G+"]")[0];return !!F&&C(F)}return(/input|select|textarea|button|object/.test(I)?!E.disabled:"a"==I?E.href||J:J)&&C(E)}B.ui=B.ui||{};B.ui.version||(B.extend(B.ui,{version:"1.8.18",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),B.fn.extend({propAttr:B.fn.prop||B.fn.attr,_focus:B.fn.focus,focus:function(E,F){return typeof E=="number"?this.each(function(){var G=this;setTimeout(function(){B(G).focus(),F&&F.call(G)},E)}):this._focus.apply(this,arguments)},scrollParent:function(){var E;B.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?E=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(B.curCSS(this,"position",1))&&/(auto|scroll)/.test(B.curCSS(this,"overflow",1)+B.curCSS(this,"overflow-y",1)+B.curCSS(this,"overflow-x",1))}).eq(0):E=this.parents().filter(function(){return/(auto|scroll)/.test(B.curCSS(this,"overflow",1)+B.curCSS(this,"overflow-y",1)+B.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!E.length?B(document):E},zIndex:function(H){if(H!==A){return this.css("zIndex",H)}if(this.length){var G=B(this[0]),F,E;while(G.length&&G[0]!==document){F=G.css("position");if(F==="absolute"||F==="relative"||F==="fixed"){E=parseInt(G.css("zIndex"),10);if(!isNaN(E)&&E!==0){return E}}G=G.parent()}}return 0},disableSelection:function(){return this.bind((B.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(E){E.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),B.each(["Width","Height"],function(J,I){function E(K,N,M,L){B.each(H,function(){N-=parseFloat(B.curCSS(K,"padding"+this,!0))||0,M&&(N-=parseFloat(B.curCSS(K,"border"+this+"Width",!0))||0),L&&(N-=parseFloat(B.curCSS(K,"margin"+this,!0))||0)});return N}var H=I==="Width"?["Left","Right"]:["Top","Bottom"],G=I.toLowerCase(),F={innerWidth:B.fn.innerWidth,innerHeight:B.fn.innerHeight,outerWidth:B.fn.outerWidth,outerHeight:B.fn.outerHeight};B.fn["inner"+I]=function(K){if(K===A){return F["inner"+I].call(this)}return this.each(function(){B(this).css(G,E(this,K)+"px")})},B.fn["outer"+I]=function(K,L){if(typeof K!="number"){return F["outer"+I].call(this,K)}return this.each(function(){B(this).css(G,E(this,K,!0,L)+"px")})}}),B.extend(B.expr[":"],{data:function(E,G,F){return !!B.data(E,F[3])},focusable:function(E){return D(E,!isNaN(B.attr(E,"tabindex")))},tabbable:function(E){var G=B.attr(E,"tabindex"),F=isNaN(G);return(F||G>=0)&&D(E,!F)}}),B(function(){var E=document.body,F=E.appendChild(F=document.createElement("div"));F.offsetHeight,B.extend(F.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),B.support.minHeight=F.offsetHeight===100,B.support.selectstart="onselectstart" in F,E.removeChild(F).style.display="none"}),B.extend(B.ui,{plugin:{add:function(E,I,H){var G=B.ui[E].prototype;for(var F in H){G.plugins[F]=G.plugins[F]||[],G.plugins[F].push([I,H[F]])}},call:function(F,E,I){var H=F.plugins[E];if(!!H&&!!F.element[0].parentNode){for(var G=0;G<H.length;G++){F.options[H[G][0]]&&H[G][1].apply(F.element,I)}}}},contains:function(F,E){return document.compareDocumentPosition?F.compareDocumentPosition(E)&16:F!==E&&F.contains(E)},hasScroll:function(E,H){if(B(E).css("overflow")==="hidden"){return !1}var G=H&&H==="left"?"scrollLeft":"scrollTop",F=!1;if(E[G]>0){return !0}E[G]=1,F=E[G]>0,E[G]=0;return F},isOverAxis:function(F,E,G){return F>E&&F<E+G},isOver:function(E,J,I,H,G,F){return B.ui.isOverAxis(E,I,G)&&B.ui.isOverAxis(J,H,F)}}))})(jQuery);(function($,undefined){function isArray(a){return a&&($.browser.safari&&typeof a=="object"&&a.length||a.constructor&&a.constructor.toString().match(/\Array\(\)/))}function extendRemove(a,b){$.extend(a,b);for(var c in b){if(b[c]==null||b[c]==undefined){a[c]=b[c]}}return a}function bindHover(a){var b="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return a.bind("mouseout",function(a){var c=$(a.target).closest(b);!c.length||c.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(c){var d=$(c.target).closest(b);!$.datepicker._isDisabledDatepicker(instActive.inline?a.parent()[0]:instActive.input[0])&&!!d.length&&(d.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),d.addClass("ui-state-hover"),d.hasClass("ui-datepicker-prev")&&d.addClass("ui-datepicker-prev-hover"),d.hasClass("ui-datepicker-next")&&d.addClass("ui-datepicker-next-hover"))})}function Datepicker(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}$.extend($.ui,{datepicker:{version:"1.8.18"}});var PROP_NAME="datepicker",dpuuid=(new Date).getTime(),instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){extendRemove(this._defaults,a||{});return this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase(),inline=nodeName=="div"||nodeName=="span";target.id||(this.uuid+=1,target.id="dp"+this.uuid);var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{}),nodeName=="input"?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(a,b){var c=a[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:c,input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:b?bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(a,b){var c=$(a);b.append=$([]),b.trigger=$([]);c.hasClass(this.markerClassName)||(this._attachments(c,b),c.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),this._autoSize(b),$.data(a,PROP_NAME,b),b.settings.disabled&&this._disableDatepicker(a))},_attachments:function(a,b){var c=this._get(b,"appendText"),d=this._get(b,"isRTL");b.append&&b.append.remove(),c&&(b.append=$('<span class="'+this._appendClass+'">'+c+"</span>"),a[d?"before":"after"](b.append)),a.unbind("focus",this._showDatepicker),b.trigger&&b.trigger.remove();var e=this._get(b,"showOn");(e=="focus"||e=="both")&&a.focus(this._showDatepicker);if(e=="button"||e=="both"){var f=this._get(b,"buttonText"),g=this._get(b,"buttonImage");b.trigger=$(this._get(b,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:g,alt:f,title:f}):$('<button type="button"></button>').addClass(this._triggerClass).html(g==""?f:$("<img/>").attr({src:g,alt:f,title:f}))),a[d?"before":"after"](b.trigger),b.trigger.click(function(){$.datepicker._datepickerShowing&&$.datepicker._lastInput==a[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!=a[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(a[0])):$.datepicker._showDatepicker(a[0]);return !1})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),c=this._get(a,"dateFormat");if(c.match(/[DM]/)){var d=function(a){var b=0,c=0;for(var d=0;d<a.length;d++){a[d].length>b&&(b=a[d].length,c=d)}return c};b.setMonth(d(this._get(a,c.match(/MM/)?"monthNames":"monthNamesShort"))),b.setDate(d(this._get(a,c.match(/DD/)?"dayNames":"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(a,b){var c=$(a);c.hasClass(this.markerClassName)||(c.addClass(this.markerClassName).append(b.dpDiv).bind("setData.datepicker",function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),$.data(a,PROP_NAME,b),this._setDate(b,this._getDefaultDate(b),!0),this._updateDatepicker(b),this._updateAlternate(b),b.settings.disabled&&this._disableDatepicker(a),b.dpDiv.css("display","block"))},_dialogDatepicker:function(a,b,c,d,e){var f=this._dialogInst;if(!f){this.uuid+=1;var g="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+g+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>'),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),f=this._dialogInst=this._newInst(this._dialogInput,!1),f.settings={},$.data(this._dialogInput[0],PROP_NAME,f)}extendRemove(f.settings,d||{}),b=b&&b.constructor==Date?this._formatDate(f,b):b,this._dialogInput.val(b),this._pos=e?e.length?e:[e.pageX,e.pageY]:null;if(!this._pos){var h=document.documentElement.clientWidth,i=document.documentElement.clientHeight,j=document.documentElement.scrollLeft||document.body.scrollLeft,k=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[h/2-100+j,i/2-150+k]}this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),f.settings.onSelect=c,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],PROP_NAME,f);return this},_destroyDatepicker:function(a){var b=$(a),c=$.data(a,PROP_NAME);if(!!b.hasClass(this.markerClassName)){var d=a.nodeName.toLowerCase();$.removeData(a,PROP_NAME),d=="input"?(c.append.remove(),c.trigger.remove(),b.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(d=="div"||d=="span")&&b.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(a){var b=$(a),c=$.data(a,PROP_NAME);if(!!b.hasClass(this.markerClassName)){var d=a.nodeName.toLowerCase();if(d=="input"){a.disabled=!1,c.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(d=="div"||d=="span"){var e=b.children("."+this._inlineClass);e.children().removeClass("ui-state-disabled"),e.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(b){return b==a?null:b})}},_disableDatepicker:function(a){var b=$(a),c=$.data(a,PROP_NAME);if(!!b.hasClass(this.markerClassName)){var d=a.nodeName.toLowerCase();if(d=="input"){a.disabled=!0,c.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(d=="div"||d=="span"){var e=b.children("."+this._inlineClass);e.children().addClass("ui-state-disabled"),e.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(b){return b==a?null:b}),this._disabledInputs[this._disabledInputs.length]=a}},_isDisabledDatepicker:function(a){if(!a){return !1}for(var b=0;b<this._disabledInputs.length;b++){if(this._disabledInputs[b]==a){return !0}}return !1},_getInst:function(a){try{return $.data(a,PROP_NAME)}catch(b){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(a,b,c){var d=this._getInst(a);if(arguments.length==2&&typeof b=="string"){return b=="defaults"?$.extend({},$.datepicker._defaults):d?b=="all"?$.extend({},d.settings):this._get(d,b):null}var e=b||{};typeof b=="string"&&(e={},e[b]=c);if(d){this._curInst==d&&this._hideDatepicker();var f=this._getDateDatepicker(a,!0),g=this._getMinMaxDate(d,"min"),h=this._getMinMaxDate(d,"max");extendRemove(d.settings,e),g!==null&&e.dateFormat!==undefined&&e.minDate===undefined&&(d.settings.minDate=this._formatDate(d,g)),h!==null&&e.dateFormat!==undefined&&e.maxDate===undefined&&(d.settings.maxDate=this._formatDate(d,h)),this._attachments($(a),d),this._autoSize(d),this._setDate(d,f),this._updateAlternate(d),this._updateDatepicker(d)}},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){var b=this._getInst(a);b&&this._updateDatepicker(b)},_setDateDatepicker:function(a,b){var c=this._getInst(a);c&&(this._setDate(c,b),this._updateDatepicker(c),this._updateAlternate(c))},_getDateDatepicker:function(a,b){var c=this._getInst(a);c&&!c.inline&&this._setDateFromField(c,b);return c?this._getDate(c):null},_doKeyDown:function(a){var b=$.datepicker._getInst(a.target),c=!0,d=b.dpDiv.is(".ui-datepicker-rtl");b._keyEvent=!0;if($.datepicker._datepickerShowing){switch(a.keyCode){case 9:$.datepicker._hideDatepicker(),c=!1;break;case 13:var e=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",b.dpDiv);e[0]&&$.datepicker._selectDay(a.target,b.selectedMonth,b.selectedYear,e[0]);var f=$.datepicker._get(b,"onSelect");if(f){var g=$.datepicker._formatDate(b);f.apply(b.input?b.input[0]:null,[g,b])}else{$.datepicker._hideDatepicker()}return !1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(a.target,a.ctrlKey?-$.datepicker._get(b,"stepBigMonths"):-$.datepicker._get(b,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(a.target,a.ctrlKey?+$.datepicker._get(b,"stepBigMonths"):+$.datepicker._get(b,"stepMonths"),"M");break;case 35:(a.ctrlKey||a.metaKey)&&$.datepicker._clearDate(a.target),c=a.ctrlKey||a.metaKey;break;case 36:(a.ctrlKey||a.metaKey)&&$.datepicker._gotoToday(a.target),c=a.ctrlKey||a.metaKey;break;case 37:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,d?1:-1,"D"),c=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&$.datepicker._adjustDate(a.target,a.ctrlKey?-$.datepicker._get(b,"stepBigMonths"):-$.datepicker._get(b,"stepMonths"),"M");break;case 38:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,-7,"D"),c=a.ctrlKey||a.metaKey;break;case 39:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,d?-1:1,"D"),c=a.ctrlKey||a.metaKey,a.originalEvent.altKey&&$.datepicker._adjustDate(a.target,a.ctrlKey?+$.datepicker._get(b,"stepBigMonths"):+$.datepicker._get(b,"stepMonths"),"M");break;case 40:(a.ctrlKey||a.metaKey)&&$.datepicker._adjustDate(a.target,7,"D"),c=a.ctrlKey||a.metaKey;break;default:c=!1}}else{a.keyCode==36&&a.ctrlKey?$.datepicker._showDatepicker(this):c=!1}c&&(a.preventDefault(),a.stopPropagation())},_doKeyPress:function(a){var b=$.datepicker._getInst(a.target);if($.datepicker._get(b,"constrainInput")){var c=$.datepicker._possibleChars($.datepicker._get(b,"dateFormat")),d=String.fromCharCode(a.charCode==undefined?a.keyCode:a.charCode);return a.ctrlKey||a.metaKey||d<" "||!c||c.indexOf(d)>-1}},_doKeyUp:function(a){var b=$.datepicker._getInst(a.target);if(b.input.val()!=b.lastVal){try{var c=$.datepicker.parseDate($.datepicker._get(b,"dateFormat"),b.input?b.input.val():null,$.datepicker._getFormatConfig(b));c&&($.datepicker._setDateFromField(b),$.datepicker._updateAlternate(b),$.datepicker._updateDatepicker(b))}catch(a){$.datepicker.log(a)}}return !0},_showDatepicker:function(a){a=a.target||a,a.nodeName.toLowerCase()!="input"&&(a=$("input",a.parentNode)[0]);if(!$.datepicker._isDisabledDatepicker(a)&&$.datepicker._lastInput!=a){var b=$.datepicker._getInst(a);$.datepicker._curInst&&$.datepicker._curInst!=b&&($.datepicker._curInst.dpDiv.stop(!0,!0),b&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0]));var c=$.datepicker._get(b,"beforeShow"),d=c?c.apply(a,[a,b]):{};if(d===!1){return }extendRemove(b.settings,d),b.lastVal=null,$.datepicker._lastInput=a,$.datepicker._setDateFromField(b),$.datepicker._inDialog&&(a.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(a),$.datepicker._pos[1]+=a.offsetHeight);var e=!1;$(a).parents().each(function(){e|=$(this).css("position")=="fixed";return !e}),e&&$.browser.opera&&($.datepicker._pos[0]-=document.documentElement.scrollLeft,$.datepicker._pos[1]-=document.documentElement.scrollTop);var f={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null,b.dpDiv.empty(),b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(b),f=$.datepicker._checkOffset(b,f,e),b.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":e?"fixed":"absolute",display:"none",left:f.left+"px",top:f.top+"px"});if(!b.inline){var g=$.datepicker._get(b,"showAnim"),h=$.datepicker._get(b,"duration"),i=function(){var a=b.dpDiv.find("iframe.ui-datepicker-cover");if(!!a.length){var c=$.datepicker._getBorders(b.dpDiv);a.css({left:-c[0],top:-c[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()})}};b.dpDiv.zIndex($(a).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&$.effects[g]?b.dpDiv.show(g,$.datepicker._get(b,"showOptions"),h,i):b.dpDiv[g||"show"](g?h:null,i),(!g||!h)&&i(),b.input.is(":visible")&&!b.input.is(":disabled")&&b.input.focus(),$.datepicker._curInst=b}}},_updateDatepicker:function(a){var b=this;b.maxRows=4;var c=$.datepicker._getBorders(a.dpDiv);instActive=a,a.dpDiv.empty().append(this._generateHTML(a));var d=a.dpDiv.find("iframe.ui-datepicker-cover");!d.length||d.css({left:-c[0],top:-c[1],width:a.dpDiv.outerWidth(),height:a.dpDiv.outerHeight()}),a.dpDiv.find("."+this._dayOverClass+" a").mouseover();var e=this._getNumberOfMonths(a),f=e[1],g=17;a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),f>1&&a.dpDiv.addClass("ui-datepicker-multi-"+f).css("width",g*f+"em"),a.dpDiv[(e[0]!=1||e[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi"),a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),a==$.datepicker._curInst&&$.datepicker._datepickerShowing&&a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&a.input[0]!=document.activeElement&&a.input.focus();if(a.yearshtml){var h=a.yearshtml;setTimeout(function(){h===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.ui-datepicker-year:first").replaceWith(a.yearshtml),h=a.yearshtml=null},0)}},_getBorders:function(a){var b=function(a){return{thin:1,medium:2,thick:3}[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(a,b,c){var d=a.dpDiv.outerWidth(),e=a.dpDiv.outerHeight(),f=a.input?a.input.outerWidth():0,g=a.input?a.input.outerHeight():0,h=document.documentElement.clientWidth+$(document).scrollLeft(),i=document.documentElement.clientHeight+$(document).scrollTop();b.left-=this._get(a,"isRTL")?d-f:0,b.left-=c&&b.left==a.input.offset().left?$(document).scrollLeft():0,b.top-=c&&b.top==a.input.offset().top+g?$(document).scrollTop():0,b.left-=Math.min(b.left,b.left+d>h&&h>d?Math.abs(b.left+d-h):0),b.top-=Math.min(b.top,b.top+e>i&&i>e?Math.abs(e+g):0);return b},_findPos:function(a){var b=this._getInst(a),c=this._get(b,"isRTL");while(a&&(a.type=="hidden"||a.nodeType!=1||$.expr.filters.hidden(a))){a=a[c?"previousSibling":"nextSibling"]}var d=$(a).offset();return[d.left,d.top]},_hideDatepicker:function(a){var b=this._curInst;if(!(!b||a&&b!=$.data(a,PROP_NAME))&&this._datepickerShowing){var c=this._get(b,"showAnim"),d=this._get(b,"duration"),e=this,f=function(){$.datepicker._tidyDialog(b),e._curInst=null};$.effects&&$.effects[c]?b.dpDiv.hide(c,$.datepicker._get(b,"showOptions"),d,f):b.dpDiv[c=="slideDown"?"slideUp":c=="fadeIn"?"fadeOut":"hide"](c?d:null,f),c||f(),this._datepickerShowing=!1;var g=this._get(b,"onClose");g&&g.apply(b.input?b.input[0]:null,[b.input?b.input.val():"",b]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(a){if(!!$.datepicker._curInst){var b=$(a.target),c=$.datepicker._getInst(b[0]);(b[0].id!=$.datepicker._mainDivId&&b.parents("#"+$.datepicker._mainDivId).length==0&&!b.hasClass($.datepicker.markerClassName)&&!b.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)||b.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=c)&&$.datepicker._hideDatepicker()}},_adjustDate:function(a,b,c){var d=$(a),e=this._getInst(d[0]);this._isDisabledDatepicker(d[0])||(this._adjustInstDate(e,b+(c=="M"?this._get(e,"showCurrentAtPos"):0),c),this._updateDatepicker(e))},_gotoToday:function(a){var b=$(a),c=this._getInst(b[0]);if(this._get(c,"gotoCurrent")&&c.currentDay){c.selectedDay=c.currentDay,c.drawMonth=c.selectedMonth=c.currentMonth,c.drawYear=c.selectedYear=c.currentYear}else{var d=new Date;c.selectedDay=d.getDate(),c.drawMonth=c.selectedMonth=d.getMonth(),c.drawYear=c.selectedYear=d.getFullYear()}this._notifyChange(c),this._adjustDate(b)},_selectMonthYear:function(a,b,c){var d=$(a),e=this._getInst(d[0]);e["selected"+(c=="M"?"Month":"Year")]=e["draw"+(c=="M"?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10),this._notifyChange(e),this._adjustDate(d)},_selectDay:function(a,b,c,d){var e=$(a);if(!$(d).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(e[0])){var f=this._getInst(e[0]);f.selectedDay=f.currentDay=$("a",d).html(),f.selectedMonth=f.currentMonth=b,f.selectedYear=f.currentYear=c,this._selectDate(a,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear))}},_clearDate:function(a){var b=$(a),c=this._getInst(b[0]);this._selectDate(b,"")},_selectDate:function(a,b){var c=$(a),d=this._getInst(c[0]);b=b!=null?b:this._formatDate(d),d.input&&d.input.val(b),this._updateAlternate(d);var e=this._get(d,"onSelect");e?e.apply(d.input?d.input[0]:null,[b,d]):d.input&&d.input.trigger("change"),d.inline?this._updateDatepicker(d):(this._hideDatepicker(),this._lastInput=d.input[0],typeof d.input[0]!="object"&&d.input.focus(),this._lastInput=null)},_updateAlternate:function(a){var b=this._get(a,"altField");if(b){var c=this._get(a,"altFormat")||this._get(a,"dateFormat"),d=this._getDate(a),e=this.formatDate(c,d,this._getFormatConfig(a));$(b).each(function(){$(this).val(e)})}},noWeekends:function(a){var b=a.getDay();return[b>0&&b<6,""]},iso8601Week:function(a){var b=new Date(a.getTime());b.setDate(b.getDate()+4-(b.getDay()||7));var c=b.getTime();b.setMonth(0),b.setDate(1);return Math.floor(Math.round((c-b)/86400000)/7)+1},parseDate:function(a,b,c){if(a==null||b==null){throw"Invalid arguments"}b=typeof b=="object"?b.toString():b+"";if(b==""){return null}var d=(c?c.shortYearCutoff:null)||this._defaults.shortYearCutoff;d=typeof d!="string"?d:(new Date).getFullYear()%100+parseInt(d,10);var e=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,g=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,h=(c?c.monthNames:null)||this._defaults.monthNames,i=-1,j=-1,k=-1,l=-1,m=!1,n=function(b){var c=s+1<a.length&&a.charAt(s+1)==b;c&&s++;return c},o=function(a){var c=n(a),d=a=="@"?14:a=="!"?20:a=="y"&&c?4:a=="o"?3:2,e=new RegExp("^\\d{1,"+d+"}"),f=b.substring(r).match(e);if(!f){throw"Missing number at position "+r}r+=f[0].length;return parseInt(f[0],10)},p=function(a,c,d){var e=$.map(n(a)?d:c,function(a,b){return[[b,a]]}).sort(function(a,b){return -(a[1].length-b[1].length)}),f=-1;$.each(e,function(a,c){var d=c[1];if(b.substr(r,d.length).toLowerCase()==d.toLowerCase()){f=c[0],r+=d.length;return !1}});if(f!=-1){return f+1}throw"Unknown name at position "+r},q=function(){if(b.charAt(r)!=a.charAt(s)){throw"Unexpected literal at position "+r}r++},r=0;for(var s=0;s<a.length;s++){if(m){a.charAt(s)=="'"&&!n("'")?m=!1:q()}else{switch(a.charAt(s)){case"d":k=o("d");break;case"D":p("D",e,f);break;case"o":l=o("o");break;case"m":j=o("m");break;case"M":j=p("M",g,h);break;case"y":i=o("y");break;case"@":var t=new Date(o("@"));i=t.getFullYear(),j=t.getMonth()+1,k=t.getDate();break;case"!":var t=new Date((o("!")-this._ticksTo1970)/10000);i=t.getFullYear(),j=t.getMonth()+1,k=t.getDate();break;case"'":n("'")?q():m=!0;break;default:q()}}}if(r<b.length){throw"Extra/unparsed characters found in date: "+b.substring(r)}i==-1?i=(new Date).getFullYear():i<100&&(i+=(new Date).getFullYear()-(new Date).getFullYear()%100+(i<=d?0:-100));if(l>-1){j=1,k=l;for(;;){var u=this._getDaysInMonth(i,j-1);if(k<=u){break}j++,k-=u}}var t=this._daylightSavingAdjust(new Date(i,j-1,k));if(t.getFullYear()!=i||t.getMonth()+1!=j||t.getDate()!=k){throw"Invalid date"}return t},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*10000000,formatDate:function(a,b,c){if(!b){return""}var d=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,e=(c?c.dayNames:null)||this._defaults.dayNames,f=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,g=(c?c.monthNames:null)||this._defaults.monthNames,h=function(b){var c=m+1<a.length&&a.charAt(m+1)==b;c&&m++;return c},i=function(a,b,c){var d=""+b;if(h(a)){while(d.length<c){d="0"+d}}return d},j=function(a,b,c,d){return h(a)?d[b]:c[b]},k="",l=!1;if(b){for(var m=0;m<a.length;m++){if(l){a.charAt(m)=="'"&&!h("'")?l=!1:k+=a.charAt(m)}else{switch(a.charAt(m)){case"d":k+=i("d",b.getDate(),2);break;case"D":k+=j("D",b.getDay(),d,e);break;case"o":k+=i("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-(new Date(b.getFullYear(),0,0)).getTime())/86400000),3);break;case"m":k+=i("m",b.getMonth()+1,2);break;case"M":k+=j("M",b.getMonth(),f,g);break;case"y":k+=h("y")?b.getFullYear():(b.getYear()%100<10?"0":"")+b.getYear()%100;break;case"@":k+=b.getTime();break;case"!":k+=b.getTime()*10000+this._ticksTo1970;break;case"'":h("'")?k+="'":l=!0;break;default:k+=a.charAt(m)}}}}return k},_possibleChars:function(a){var b="",c=!1,d=function(b){var c=e+1<a.length&&a.charAt(e+1)==b;c&&e++;return c};for(var e=0;e<a.length;e++){if(c){a.charAt(e)=="'"&&!d("'")?c=!1:b+=a.charAt(e)}else{switch(a.charAt(e)){case"d":case"m":case"y":case"@":b+="0123456789";break;case"D":case"M":return null;case"'":d("'")?b+="'":c=!0;break;default:b+=a.charAt(e)}}}return b},_get:function(a,b){return a.settings[b]!==undefined?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,e,f;e=f=this._getDefaultDate(a);var g=this._getFormatConfig(a);try{e=this.parseDate(c,d,g)||f}catch(h){this.log(h),d=b?"":d}a.selectedDay=e.getDate(),a.drawMonth=a.selectedMonth=e.getMonth(),a.drawYear=a.selectedYear=e.getFullYear(),a.currentDay=d?e.getDate():0,a.currentMonth=d?e.getMonth():0,a.currentYear=d?e.getFullYear():0,this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(a,b,c){var d=function(a){var b=new Date;b.setDate(b.getDate()+a);return b},e=function(b){try{return $.datepicker.parseDate($.datepicker._get(a,"dateFormat"),b,$.datepicker._getFormatConfig(a))}catch(c){}var d=(b.toLowerCase().match(/^c/)?$.datepicker._getDate(a):null)||new Date,e=d.getFullYear(),f=d.getMonth(),g=d.getDate(),h=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,i=h.exec(b);while(i){switch(i[2]||"d"){case"d":case"D":g+=parseInt(i[1],10);break;case"w":case"W":g+=parseInt(i[1],10)*7;break;case"m":case"M":f+=parseInt(i[1],10),g=Math.min(g,$.datepicker._getDaysInMonth(e,f));break;case"y":case"Y":e+=parseInt(i[1],10),g=Math.min(g,$.datepicker._getDaysInMonth(e,f))}i=h.exec(b)}return new Date(e,f,g)},f=b==null||b===""?c:typeof b=="string"?e(b):typeof b=="number"?isNaN(b)?c:d(b):new Date(b.getTime());f=f&&f.toString()=="Invalid Date"?c:f,f&&(f.setHours(0),f.setMinutes(0),f.setSeconds(0),f.setMilliseconds(0));return this._daylightSavingAdjust(f)},_daylightSavingAdjust:function(a){if(!a){return null}a.setHours(a.getHours()>12?a.getHours()+2:0);return a},_setDate:function(a,b,c){var d=!b,e=a.selectedMonth,f=a.selectedYear,g=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=g.getDate(),a.drawMonth=a.selectedMonth=a.currentMonth=g.getMonth(),a.drawYear=a.selectedYear=a.currentYear=g.getFullYear(),(e!=a.selectedMonth||f!=a.selectedYear)&&!c&&this._notifyChange(a),this._adjustInstDate(a),a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){var b=!a.currentYear||a.input&&a.input.val()==""?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return b},_generateHTML:function(a){var b=new Date;b=this._daylightSavingAdjust(new Date(b.getFullYear(),b.getMonth(),b.getDate()));var c=this._get(a,"isRTL"),d=this._get(a,"showButtonPanel"),e=this._get(a,"hideIfNoPrevNext"),f=this._get(a,"navigationAsDateFormat"),g=this._getNumberOfMonths(a),h=this._get(a,"showCurrentAtPos"),i=this._get(a,"stepMonths"),j=g[0]!=1||g[1]!=1,k=this._daylightSavingAdjust(a.currentDay?new Date(a.currentYear,a.currentMonth,a.currentDay):new Date(9999,9,9)),l=this._getMinMaxDate(a,"min"),m=this._getMinMaxDate(a,"max"),n=a.drawMonth-h,o=a.drawYear;n<0&&(n+=12,o--);if(m){var p=this._daylightSavingAdjust(new Date(m.getFullYear(),m.getMonth()-g[0]*g[1]+1,m.getDate()));p=l&&p<l?l:p;while(this._daylightSavingAdjust(new Date(o,n,1))>p){n--,n<0&&(n=11,o--)}}a.drawMonth=n,a.drawYear=o;var q=this._get(a,"prevText");q=f?this.formatDate(q,this._daylightSavingAdjust(new Date(o,n-i,1)),this._getFormatConfig(a)):q;var r=this._canAdjustMonth(a,-1,o,n)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+a.id+"', -"+i+", 'M');\" title=\""+q+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+q+"</span></a>":e?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+q+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+q+"</span></a>",s=this._get(a,"nextText");s=f?this.formatDate(s,this._daylightSavingAdjust(new Date(o,n+i,1)),this._getFormatConfig(a)):s;var t=this._canAdjustMonth(a,1,o,n)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._adjustDate('#"+a.id+"', +"+i+", 'M');\" title=\""+s+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+s+"</span></a>":e?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+s+"</span></a>",u=this._get(a,"currentText"),v=this._get(a,"gotoCurrent")&&a.currentDay?k:b;u=f?this.formatDate(u,v,this._getFormatConfig(a)):u;var w=a.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+dpuuid+'.datepicker._hideDatepicker();">'+this._get(a,"closeText")+"</button>",x=d?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(c?w:"")+(this._isInRange(a,v)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+dpuuid+".datepicker._gotoToday('#"+a.id+"');\">"+u+"</button>":"")+(c?"":w)+"</div>":"",y=parseInt(this._get(a,"firstDay"),10);y=isNaN(y)?0:y;var z=this._get(a,"showWeek"),A=this._get(a,"dayNames"),B=this._get(a,"dayNamesShort"),C=this._get(a,"dayNamesMin"),D=this._get(a,"monthNames"),E=this._get(a,"monthNamesShort"),F=this._get(a,"beforeShowDay"),G=this._get(a,"showOtherMonths"),H=this._get(a,"selectOtherMonths"),I=this._get(a,"calculateWeek")||this.iso8601Week,J=this._getDefaultDate(a),K="";for(var L=0;L<g[0];L++){var M="";this.maxRows=4;for(var N=0;N<g[1];N++){var O=this._daylightSavingAdjust(new Date(o,n,a.selectedDay)),P=" ui-corner-all",Q="";if(j){Q+='<div class="ui-datepicker-group';if(g[1]>1){switch(N){case 0:Q+=" ui-datepicker-group-first",P=" ui-corner-"+(c?"right":"left");break;case g[1]-1:Q+=" ui-datepicker-group-last",P=" ui-corner-"+(c?"left":"right");break;default:Q+=" ui-datepicker-group-middle",P=""}}Q+='">'}Q+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+P+'">'+(/all|left/.test(P)&&L==0?c?t:r:"")+(/all|right/.test(P)&&L==0?c?r:t:"")+this._generateMonthYearHeader(a,n,o,l,m,L>0||N>0,D,E)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var R=z?'<th class="ui-datepicker-week-col">'+this._get(a,"weekHeader")+"</th>":"";for(var S=0;S<7;S++){var T=(S+y)%7;R+="<th"+((S+y+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+A[T]+'">'+C[T]+"</span></th>"}Q+=R+"</tr></thead><tbody>";var U=this._getDaysInMonth(o,n);o==a.selectedYear&&n==a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,U));var V=(this._getFirstDayOfMonth(o,n)-y+7)%7,W=Math.ceil((V+U)/7),X=j?this.maxRows>W?this.maxRows:W:W;this.maxRows=X;var Y=this._daylightSavingAdjust(new Date(o,n,1-V));for(var Z=0;Z<X;Z++){Q+="<tr>";var _=z?'<td class="ui-datepicker-week-col">'+this._get(a,"calculateWeek")(Y)+"</td>":"";for(var S=0;S<7;S++){var ba=F?F.apply(a.input?a.input[0]:null,[Y]):[!0,""],bb=Y.getMonth()!=n,bc=bb&&!H||!ba[0]||l&&Y<l||m&&Y>m;_+='<td class="'+((S+y+6)%7>=5?" ui-datepicker-week-end":"")+(bb?" ui-datepicker-other-month":"")+(Y.getTime()==O.getTime()&&n==a.selectedMonth&&a._keyEvent||J.getTime()==Y.getTime()&&J.getTime()==O.getTime()?" "+this._dayOverClass:"")+(bc?" "+this._unselectableClass+" ui-state-disabled":"")+(bb&&!G?"":" "+ba[1]+(Y.getTime()==k.getTime()?" "+this._currentClass:"")+(Y.getTime()==b.getTime()?" ui-datepicker-today":""))+'"'+((!bb||G)&&ba[2]?' title="'+ba[2]+'"':"")+(bc?"":' onclick="DP_jQuery_'+dpuuid+".datepicker._selectDay('#"+a.id+"',"+Y.getMonth()+","+Y.getFullYear()+', this);return false;"')+">"+(bb&&!G?"&#xa0;":bc?'<span class="ui-state-default">'+Y.getDate()+"</span>":'<a class="ui-state-default'+(Y.getTime()==b.getTime()?" ui-state-highlight":"")+(Y.getTime()==k.getTime()?" ui-state-active":"")+(bb?" ui-priority-secondary":"")+'" href="#">'+Y.getDate()+"</a>")+"</td>",Y.setDate(Y.getDate()+1),Y=this._daylightSavingAdjust(Y)}Q+=_+"</tr>"}n++,n>11&&(n=0,o++),Q+="</tbody></table>"+(j?"</div>"+(g[0]>0&&N==g[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),M+=Q}K+=M}K+=x+($.browser.msie&&parseInt($.browser.version,10)<7&&!a.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),a._keyEvent=!1;return K},_generateMonthYearHeader:function(a,b,c,d,e,f,g,h){var i=this._get(a,"changeMonth"),j=this._get(a,"changeYear"),k=this._get(a,"showMonthAfterYear"),l='<div class="ui-datepicker-title">',m="";if(f||!i){m+='<span class="ui-datepicker-month">'+g[b]+"</span>"}else{var n=d&&d.getFullYear()==c,o=e&&e.getFullYear()==c;m+='<select class="ui-datepicker-month" onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+a.id+"', this, 'M');\" >";for(var p=0;p<12;p++){(!n||p>=d.getMonth())&&(!o||p<=e.getMonth())&&(m+='<option value="'+p+'"'+(p==b?' selected="selected"':"")+">"+h[p]+"</option>")}m+="</select>"}k||(l+=m+(f||!i||!j?"&#xa0;":""));if(!a.yearshtml){a.yearshtml="";if(f||!j){l+='<span class="ui-datepicker-year">'+c+"</span>"}else{var q=this._get(a,"yearRange").split(":"),r=(new Date).getFullYear(),s=function(a){var b=a.match(/c[+-].*/)?c+parseInt(a.substring(1),10):a.match(/[+-].*/)?r+parseInt(a,10):parseInt(a,10);return isNaN(b)?r:b},t=s(q[0]),u=Math.max(t,s(q[1]||""));t=d?Math.max(t,d.getFullYear()):t,u=e?Math.min(u,e.getFullYear()):u,a.yearshtml+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+dpuuid+".datepicker._selectMonthYear('#"+a.id+"', this, 'Y');\" >";for(;t<=u;t++){a.yearshtml+='<option value="'+t+'"'+(t==c?' selected="selected"':"")+">"+t+"</option>"}a.yearshtml+="</select>",l+=a.yearshtml,a.yearshtml=null}}l+=this._get(a,"yearSuffix"),k&&(l+=(f||!i||!j?"&#xa0;":"")+m),l+="</div>";return l},_adjustInstDate:function(a,b,c){var d=a.drawYear+(c=="Y"?b:0),e=a.drawMonth+(c=="M"?b:0),f=Math.min(a.selectedDay,this._getDaysInMonth(d,e))+(c=="D"?b:0),g=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(d,e,f)));a.selectedDay=g.getDate(),a.drawMonth=a.selectedMonth=g.getMonth(),a.drawYear=a.selectedYear=g.getFullYear(),(c=="M"||c=="Y")&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max"),e=c&&b<c?c:b;e=d&&e>d?d:e;return e},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){var b=this._get(a,"numberOfMonths");return b==null?[1,1]:typeof b=="number"?[1,b]:b},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,d){var e=this._getNumberOfMonths(a),f=this._daylightSavingAdjust(new Date(c,d+(b<0?b:e[0]*e[1]),1));b<0&&f.setDate(this._getDaysInMonth(f.getFullYear(),f.getMonth()));return this._isInRange(a,f)},_isInRange:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max");return(!c||b.getTime()>=c.getTime())&&(!d||b.getTime()<=d.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");b=typeof b!="string"?b:(new Date).getFullYear()%100+parseInt(b,10);return{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,d){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);var e=b?typeof b=="object"?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),e,this._getFormatConfig(a))}}),$.fn.datepicker=function(a){if(!this.length){return this}$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv),$.datepicker.initialized=!0);var b=Array.prototype.slice.call(arguments,1);if(typeof a=="string"&&(a=="isDisabled"||a=="getDate"||a=="widget")){return $.datepicker["_"+a+"Datepicker"].apply($.datepicker,[this[0]].concat(b))}if(a=="option"&&arguments.length==2&&typeof arguments[1]=="string"){return $.datepicker["_"+a+"Datepicker"].apply($.datepicker,[this[0]].concat(b))}return this.each(function(){typeof a=="string"?$.datepicker["_"+a+"Datepicker"].apply($.datepicker,[this].concat(b)):$.datepicker._attachDatepicker(this,a)})},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.8.18",window["DP_jQuery_"+dpuuid]=$})(jQuery);gumtree.init.postAd._onDomReady=(function(){var A=gumtree.init.postAd;A.contactMethodEnforcement();A.setupGrids();A.categoryTermsLightbox();A.setContinueState();A.setupAsyncFormValidation();A.formMerger();A.vrnPromptFlow();A.datePickers();A.maxLengthDescription();A.maxLengthIndicator();A.mediaUploader();A.preventEnterSubmit();A.linkedUrgentTrigger();A.linkedUrlTrigger();A.checkUrlFeatureOnKeyDown();A.checkUrlFeatureOnChange();A.previewLightbox();A.deleteAdLightbox();A.featureLightboxes();A.listenToClearEvent();A.promoteAddListener();A.displayTotalPrice();A.addDescriptionTextPointer();A.onFormSubmit();A.setupDiscountedFeaturedSelect();A.autoResizeDescription()});domReady(function(){gumtree.init.postAd._onDomReady()});gumtree.init.postAd._onDomChange=(function(){gumtree.init.global.errorMessageAnchorSubmit();gumtree.init.global.replaceSelects();gumtree.init.global.doFormInputWrappers();gumtree.init.global.doFormPlaceholders();gumtree.init.global.formInputClearControls();gumtree.init.global.selectAlls();gumtree.init.postAd._onDomReady()})